<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>UniFrac Algorithms • rbiom</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Noto_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="UniFrac Algorithms">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rbiom</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rbiom.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Analysis Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/rbiom.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/importing.html">Importing Your Data</a></li>
    <li><a class="dropdown-item" href="../reference/rbiom_objects.html">Working with rbiom Objects</a></li>
    <li><a class="dropdown-item" href="../articles/statistics.html">Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">Regression</a></li>
    <li><a class="dropdown-item" href="../reference/speed.html">Speed Ups</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Plotting</h6></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Plot Types</a></li>
    <li><a class="dropdown-item" href="../articles/aes.html">Mapping Metadata to Aesthetics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/convert.html">QIIME 2, mothur, and BioConductor</a></li>
    <li><a class="dropdown-item" href="../articles/unifrac.html">UniFrac Equations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cmmr/rbiom/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>UniFrac Algorithms</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cmmr/rbiom/blob/master/vignettes/articles/unifrac.Rmd" class="external-link"><code>vignettes/articles/unifrac.Rmd</code></a></small>
      <div class="d-none name"><code>unifrac.Rmd</code></div>
    </div>

    
    
<style type="text/css">

.sourceCode           { display: none;   }
math[display="block"] { font-size: 22px; }

img {
  background-color: #fff;
  border: 2px gray solid;
}

.center {
  margin-left: auto;
  margin-right: auto;
}

.otu_matrix {
  width: 80%; 
  border-width: 0;
  border-collapse: separate;
  padding: 10px;
  font-size: 14pt;
  margin-left: auto;
  margin-right: auto;
}

.def_table {
  font-size: 12pt;
  margin-left: auto;
  margin-right: auto;
}
.def_table td {
  padding: 10px; 
}

.level2 {
  margin-top: 40px;
}

.level1 {
  margin-top: 50px;
}

</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The different UniFrac algorithms are listed below, along with
examples for calculating them.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">json</span> <span class="op">&lt;-</span> <span class="st">'{"id":"","comment":"","date":"2025-01-29T22:14:00Z","format":"1.0.0","type":"OTU table","format_url":"http://biom-format.org","generated_by":"rbiom 2.0.13","matrix_type":"sparse","matrix_element_type":"int","shape":[5,2],"phylogeny":"(((OTU_1:0.8,OTU_2:0.5):0.4,OTU_3:0.9):0.2,(OTU_4:0.7,OTU_5:0.3):0.6);","rows":{"1":{"id":"OTU_1"},"2":{"id":"OTU_2"},"3":{"id":"OTU_3"},"4":{"id":"OTU_4"},"5":{"id":"OTU_5"}},"columns":[{"id":"Sample_1"},{"id":"Sample_2"}],"data":[[2,0,9],[3,0,3],[4,0,3],[0,1,1],[1,1,4],[2,1,2],[3,1,8]]}'</span></span>
<span></span>
<span><span class="va">biom</span> <span class="op">&lt;-</span> <span class="fu">rbiom</span><span class="fu">::</span><span class="fu"><a href="../reference/as_rbiom.html">as_rbiom</a></span><span class="op">(</span><span class="va">json</span>, underscores <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mtx</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">phy</span>  <span class="op">&lt;-</span> <span class="va">biom</span><span class="op">$</span><span class="va">tree</span></span>
<span></span>
<span><span class="va">L</span> <span class="op">&lt;-</span> <span class="va">phy</span><span class="op">$</span><span class="va">edge.length</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">9</span>,<span class="fl">6</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">8</span>,<span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>An OTU matrix with two samples and five OTUs.</li>
<li>A phylogenetic tree for those five OTUs.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mtx</span>, format<span class="op">=</span><span class="st">"html"</span>, table.attr<span class="op">=</span><span class="st">'class="otu_matrix" cellspacing="0"'</span>, align<span class="op">=</span><span class="st">'c'</span><span class="op">)</span></span></code></pre></div>
<table class="table otu_matrix" cellspacing="0">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
OTU_1
</th>
<th style="text-align:center;">
OTU_2
</th>
<th style="text-align:center;">
OTU_3
</th>
<th style="text-align:center;">
OTU_4
</th>
<th style="text-align:center;">
OTU_5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Sample_1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample_2
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>xpd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  x          <span class="op">=</span> <span class="va">phy</span>, </span>
<span>  direction  <span class="op">=</span> <span class="st">'downwards'</span>, </span>
<span>  srt        <span class="op">=</span> <span class="fl">90</span>, </span>
<span>  adj        <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  no.margin  <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  underscore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x.lim      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5.5</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">edgelabels</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">edge.length</span>, bg <span class="op">=</span> <span class="st">'white'</span>, frame <span class="op">=</span> <span class="st">'none'</span>, adj <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p><img src="unifrac_files/figure-html/input_data_tree-1.png" width="75%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="definitions">Definitions<a class="anchor" aria-label="anchor" href="#definitions"></a>
</h2>
<p>The branch indices (green circles) are used for ordering the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
arrays. Values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>
are drawn from the input phylogenetic tree. Values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
are the total number of OTU observations descending from that branch;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
for Sample_1, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
for Sample_2.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">local</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">phy</span><span class="op">$</span><span class="va">edge.length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>xpd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>    x               <span class="op">=</span> <span class="va">phy</span>, </span>
<span>    direction       <span class="op">=</span> <span class="st">'downwards'</span>, </span>
<span>    srt             <span class="op">=</span> <span class="fl">90</span>, </span>
<span>    adj             <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    no.margin       <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    underscore      <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    x.lim           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">edgelabels</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, frame <span class="op">=</span> <span class="st">'circle'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">edgelabels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'A ='</span>, <span class="va">A</span><span class="op">)</span>, bg <span class="op">=</span> <span class="st">'white'</span>, frame <span class="op">=</span> <span class="st">'none'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>, <span class="op">-</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">edgelabels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'B ='</span>, <span class="va">B</span><span class="op">)</span>, bg <span class="op">=</span> <span class="st">'white'</span>, frame <span class="op">=</span> <span class="st">'none'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>,  <span class="fl">0.0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">edgelabels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'L ='</span>, <span class="va">L</span><span class="op">)</span>, bg <span class="op">=</span> <span class="st">'white'</span>, frame <span class="op">=</span> <span class="st">'none'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,  <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p><img src="unifrac_files/figure-html/definitions-1.png" width="75%" style="display: block; margin: auto;"></p>
<p><br></p>
<table class="table def_table center">
<tr>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">n = 8</annotation></semantics></math>
</td>
<td>
Number of branches
</td>
</tr>
<tr>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>9</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>9</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">A = \{9, 0, 0, 0, 9, 6, 3, 3\}</annotation></semantics></math>
</td>
<td>
Branch <strong>weights</strong> for Sample_1.
</td>
</tr>
<tr>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>7</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">B = \{7, 5, 1, 4, 2, 8, 8, 0\}</annotation></semantics></math>
</td>
<td>
Branch <strong>weights</strong> for Sample_2.
</td>
</tr>
<tr>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>T</mi></msub><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">A_T = 15</annotation></semantics></math>
</td>
<td>
Total OTU counts for Sample_1.
</td>
</tr>
<tr>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>T</mi></msub><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">B_T = 15</annotation></semantics></math>
</td>
<td>
Total OTU counts for Sample_2.
</td>
</tr>
<tr>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>0.2</mn><mo>,</mo><mn>0.4</mn><mo>,</mo><mn>0.8</mn><mo>,</mo><mn>0.5</mn><mo>,</mo><mn>0.9</mn><mo>,</mo><mn>0.6</mn><mo>,</mo><mn>0.7</mn><mo>,</mo><mn>0.3</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">L = \{0.2, 0.4, 0.8, 0.5, 0.9, 0.6, 0.7, 0.3\}</annotation></semantics></math>
</td>
<td>
The branch <strong>lengths</strong>.
</td>
</tr>
</table>
<p><br></p>
</div>
<div class="section level2">
<h2 id="unweighted">Unweighted<a class="anchor" aria-label="anchor" href="#unweighted"></a>
</h2>
<ul>
<li>
<a href="https://doi.org/10.1128/AEM.71.12.8228-8235.2005" class="external-link">Lozupone
et al, 2005</a>: Unweighted UniFrac</li>
<li>R Package <a href="https://cran.r-project.org/package=rbiom" class="external-link">rbiom</a>:
<code>bdiv_matrix(bdiv = "unifrac", weighted=FALSE)</code>
</li>
<li>R Package <a href="https://doi.org/doi:10.18129/B9.bioc.phyloseq" class="external-link">phyloseq</a>:
<code>UniFrac(weighted=FALSE)</code>
</li>
<li>R Package <a href="https://doi.org/10.32614/CRAN.package.abdiv" class="external-link">abdiv</a>:
<code>unweighted_unifrac()</code>
</li>
<li>
<a href="https://qiime2.org/" class="external-link">qiime2</a>
<code>qiime diversity beta-phylogenetic --p-metric unweighted_unifrac</code>
</li>
<li>
<a href="https://mothur.org/" class="external-link">mothur</a>:
<code>unifrac.unweighted()</code>
</li>
</ul>
<p>First, transform A and B into presence (1) and absence (0)
indicators.</p>
<table class="table center" style="width:75%"><tr>
<td style="border-width:0">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>A</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>9</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>9</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>A</mi><mi>′</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
A  &amp;= \{9, 0, 0, 0, 9, 6, 3, 3\} \\
A' &amp;= \{1, 0, 0, 0, 1, 1, 1, 1\}
\end{align*}</annotation></semantics></math></p>
</td>
<td style="border-width:0">
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>B</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>7</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>8</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>B</mi><mi>′</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
B  &amp;= \{7, 5, 1, 4, 2, 8, 8, 0\} \\
B' &amp;= \{1, 1, 1, 1, 1, 1, 1, 0\}
\end{align*}</annotation></semantics></math></p>
</td>
</tr></table>
<p>Then apply the formula:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>U</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>A</mi><msub><mi>′</mi><mi>i</mi></msub><mo>−</mo><mi>B</mi><msub><mi>′</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><msub><mi>′</mi><mi>i</mi></msub><mo>,</mo><mi>B</mi><msub><mi>′</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>U</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>A</mi><msub><mi>′</mi><mn>1</mn></msub><mo>−</mo><mi>B</mi><msub><mi>′</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>L</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>A</mi><msub><mi>′</mi><mn>2</mn></msub><mo>−</mo><mi>B</mi><msub><mi>′</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>L</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>A</mi><msub><mi>′</mi><mi>n</mi></msub><mo>−</mo><mi>B</mi><msub><mi>′</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><msub><mi>′</mi><mn>1</mn></msub><mo>,</mo><mi>B</mi><msub><mi>′</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>L</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><msub><mi>′</mi><mn>2</mn></msub><mo>,</mo><mi>B</mi><msub><mi>′</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>L</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><msub><mi>′</mi><mi>n</mi></msub><mo>,</mo><mi>B</mi><msub><mi>′</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>U</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mn>0.2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mn>1</mn><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.4</mn><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mn>0</mn><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><mn>0.3</mn><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><mn>1</mn><mo>−</mo><mn>0</mn><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>0.2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.4</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><mn>0.3</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>U</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mn>0.2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.4</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.8</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.5</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.9</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.6</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.7</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.3</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>0.2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.4</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.8</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.5</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.9</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.6</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.7</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.3</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>U</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mn>0.4</mn><mo>+</mo><mn>0.8</mn><mo>+</mo><mn>0.5</mn><mo>+</mo><mn>0.3</mn></mrow><mrow><mn>0.2</mn><mo>+</mo><mn>0.4</mn><mo>+</mo><mn>0.8</mn><mo>+</mo><mn>0.5</mn><mo>+</mo><mn>0.9</mn><mo>+</mo><mn>0.6</mn><mo>+</mo><mn>0.7</mn><mo>+</mo><mn>0.3</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>U</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>2</mn><mn>4.4</mn></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>U</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>0.4545455</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
U &amp;= \displaystyle \frac{\sum_{i = 1}^{n} L_i(|A'_i - B'_i|)}{\sum_{i = 1}^{n} L_i(max(A'_i,B'_i))}  \\ \\
U &amp;= \displaystyle \frac{L_1(|A'_1-B'_1|) + L_2(|A'_2-B'_2|) + \cdots + L_n(|A'_n-B'_n|)}{L_1(max(A'_1,B'_1)) + L_2(max(A'_2,B'_2)) + \cdots + L_n(max(A'_n,B'_n))}  \\ \\
U &amp;= \displaystyle \frac{0.2(|1-1|) + 0.4(|0-1|) + \cdots + 0.3(|1-0|)}{0.2(max(1,1)) + 0.4(max(0,1)) + \cdots + 0.3(max(1,0))}  \\ \\
U &amp;= \displaystyle \frac{0.2(0) + 0.4(1) + 0.8(1) + 0.5(1) + 0.9(0) + 0.6(0) + 0.7(0) + 0.3(1)}{0.2(1) + 0.4(1) + 0.8(1) + 0.5(1) + 0.9(1) + 0.6(1) + 0.7(1) + 0.3(1)}  \\ \\
U &amp;= \displaystyle \frac{0.4 + 0.8 + 0.5 + 0.3}{0.2 + 0.4 + 0.8 + 0.5 + 0.9 + 0.6 + 0.7 + 0.3}  \\ \\
U &amp;= \displaystyle \frac{2}{4.4}  \\ \\
U &amp;= 0.4545455
\end{align*}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="weighted">Weighted<a class="anchor" aria-label="anchor" href="#weighted"></a>
</h2>
<ul>
<li>
<a href="https://doi.org/10.1128/AEM.01996-06" class="external-link">Lozupone et al,
2007</a>: Raw Weighted UniFrac</li>
<li>R Package <a href="https://cran.r-project.org/package=rbiom" class="external-link">rbiom</a>:
<code>bdiv_matrix(bdiv = "unifrac", weighted=TRUE, normalized=FALSE)</code>
</li>
<li>R Package <a href="https://doi.org/doi:10.18129/B9.bioc.phyloseq" class="external-link">phyloseq</a>:
<code>UniFrac(weighted=TRUE, normalized=FALSE)</code>
</li>
<li>R Package <a href="https://doi.org/10.32614/CRAN.package.abdiv" class="external-link">abdiv</a>:
<code>weighted_unifrac()</code>
</li>
<li>
<a href="https://qiime2.org/" class="external-link">qiime2</a>
<code>qiime diversity beta-phylogenetic --p-metric weighted_unifrac</code>
</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>W</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>W</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><msub><mi>L</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mn>2</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mn>2</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>L</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mi>n</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mi>n</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>W</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>0.2</mn><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mn>9</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>7</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mn>0.4</mn><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>5</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><mn>0.3</mn><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mn>3</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>W</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>0.02</mn><mover><mn>6</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.1</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.05</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.1</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.42</mn><mo>+</mo><mn>0.08</mn><mo>+</mo><mn>0.2</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.06</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>W</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1.14</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
W &amp;= \sum_{i = 1}^{n} L_i|\frac{A_i}{A_T} - \frac{B_i}{B_T}|  \\ \\
W &amp;= L_1|\frac{A_1}{A_T} - \frac{B_1}{B_T}| + L_2|\frac{A_2}{A_T} - \frac{B_2}{B_T}| + \cdots + L_n|\frac{A_n}{A_T} - \frac{B_n}{B_T}|  \\ \\
W &amp;= 0.2|\frac{9}{15} - \frac{7}{15}| + 0.4|\frac{0}{15} - \frac{5}{15}| + \cdots + 0.3|\frac{3}{15} - \frac{0}{15}|  \\ \\
W &amp;= 0.02\overline{6} + 0.1\overline{3} + 0.05\overline{3} + 0.1\overline{3} + 0.42 + 0.08 + 0.2\overline{3} + 0.06  \\ \\
W &amp;= 1.14
\end{align*}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="normalized">Normalized<a class="anchor" aria-label="anchor" href="#normalized"></a>
</h2>
<ul>
<li>
<a href="https://doi.org/10.1128/AEM.01996-06" class="external-link">Lozupone et al,
2007</a>: Normalized Weighted UniFrac</li>
<li>R Package <a href="https://cran.r-project.org/package=rbiom" class="external-link">rbiom</a>:
<code>bdiv_matrix(bdiv = "unifrac", weighted=TRUE, normalized=TRUE)</code>
</li>
<li>R Package <a href="https://doi.org/doi:10.18129/B9.bioc.phyloseq" class="external-link">phyloseq</a>:
<code>UniFrac(weighted=TRUE, normalized=TRUE)</code>
</li>
<li>R Package <a href="https://doi.org/10.32614/CRAN.package.abdiv" class="external-link">abdiv</a>:
<code>weighted_normalized_unifrac()</code>
</li>
<li>
<a href="https://qiime2.org/" class="external-link">qiime2</a>
<code>qiime diversity beta-phylogenetic --p-metric weighted_normalized_unifrac</code>
</li>
<li>
<a href="https://mothur.org/" class="external-link">mothur</a>:
<code>unifrac.weighted()</code>
</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>N</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>N</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><msub><mi>L</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mn>2</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mn>2</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>L</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mi>n</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mi>n</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mrow><mrow><msub><mi>L</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>L</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mn>2</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mn>2</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>L</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mi>n</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>n</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>N</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mn>0.2</mn><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mn>9</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>7</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mn>0.4</mn><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>5</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><mn>0.3</mn><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mn>3</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mrow><mrow><mn>0.2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>9</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>7</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.4</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>5</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><mn>0.3</mn><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>3</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>N</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mn>0.02</mn><mover><mn>6</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.1</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.05</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.1</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.42</mn><mo>+</mo><mn>0.08</mn><mo>+</mo><mn>0.2</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.06</mn></mrow><mrow><mn>0.21</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.1</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.05</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.1</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.66</mn><mo>+</mo><mn>0.56</mn><mo>+</mo><mn>0.51</mn><mover><mn>3</mn><mo accent="true">¯</mo></mover><mo>+</mo><mn>0.06</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>N</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1.14</mn><mn>2.326667</mn></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>N</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>0.4899713</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}

N &amp;= \displaystyle \frac
  {\sum_{i = 1}^{n} L_i|\frac{A_i}{A_T} - \frac{B_i}{B_T}|}
  {\sum_{i = 1}^{n} L_i(\frac{A_i}{A_T} + \frac{B_i}{B_T})}
  \\ \\
  
N &amp;= \displaystyle \frac
  {L_1|\frac{A_1}{A_T} - \frac{B_1}{B_T}| + L_2|\frac{A_2}{A_T} - \frac{B_2}{B_T}| + \cdots + L_n|\frac{A_n}{A_T} - \frac{B_n}{B_T}|}
  {L_1(\frac{A_1}{A_T} + \frac{B_1}{B_T}) + L_2(\frac{A_2}{A_T} + \frac{B_2}{B_T}) + \cdots + L_n(\frac{A_n}{A_T} + \frac{B_n}{B_T})}
  \\ \\
  
N &amp;= \displaystyle \frac
  {0.2|\frac{9}{15} - \frac{7}{15}| + 0.4|\frac{0}{15} - \frac{5}{15}| + \cdots + 0.3|\frac{3}{15} - \frac{0}{15}|}
  {0.2(\frac{9}{15} + \frac{7}{15}) + 0.4(\frac{0}{15} + \frac{5}{15}) + \cdots + 0.3(\frac{3}{15} + \frac{0}{15})}
  \\ \\
  
N &amp;= \displaystyle \frac
  {0.02\overline{6} + 0.1\overline{3} + 0.05\overline{3} + 0.1\overline{3} + 0.42 + 0.08 + 0.2\overline{3} + 0.06}
  {0.21\overline{3} + 0.1\overline{3} + 0.05\overline{3} + 0.1\overline{3} + 0.66 + 0.56 + 0.51\overline{3} + 0.06}
  \\ \\
  
N &amp;= \displaystyle \frac{1.14}{2.326667}  \\ \\
N &amp;= 0.4899713
\end{align*}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="generalized">Generalized<a class="anchor" aria-label="anchor" href="#generalized"></a>
</h2>
<ul>
<li>
<a href="https://doi.org/10.1093/bioinformatics/bts342" class="external-link">Chen et
al. 2012</a>: Generalized UniFrac</li>
<li>R Package <a href="https://cran.r-project.org/web/packages/GUniFrac/index.html" class="external-link">GUniFrac</a>:
<code>GUniFrac(alpha=0.5)</code>
</li>
<li>R Package <a href="https://doi.org/10.32614/CRAN.package.abdiv" class="external-link">abdiv</a>:
<code>generalized_unifrac(alpha = 0.5)</code>
</li>
<li>
<a href="https://qiime2.org/" class="external-link">qiime2</a>
<code>qiime diversity beta-phylogenetic --p-metric generalized_unifrac -a 0.5</code>
</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>G</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mrow><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac></mrow><mrow><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>G</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><msub><mi>L</mi><mn>1</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mrow><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac></mrow><mrow><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>L</mi><mi>n</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mi>n</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>n</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mrow><mfrac><msub><mi>A</mi><mi>n</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mi>n</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac></mrow><mrow><mfrac><msub><mi>A</mi><mi>n</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>n</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mrow><mrow><msub><mi>L</mi><mn>1</mn></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>L</mi><mi>n</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>A</mi><mi>n</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>n</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>G</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><mn>0.2</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>9</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>7</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mrow><mfrac><mn>9</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>7</mn><mn>15</mn></mfrac></mrow><mrow><mfrac><mn>9</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>7</mn><mn>15</mn></mfrac></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mi>⋯</mi><mo>+</mo><mn>0.3</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>3</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><mrow><mfrac><mn>3</mn><mn>15</mn></mfrac><mo>−</mo><mfrac><mn>0</mn><mn>15</mn></mfrac></mrow><mrow><mfrac><mn>3</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>0</mn><mn>15</mn></mfrac></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mrow><mrow><mn>0.2</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>9</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>7</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup><mo>+</mo><mi>⋯</mi><mo>+</mo><mn>0.3</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>3</mn><mn>15</mn></mfrac><mo>+</mo><mfrac><mn>0</mn><mn>15</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>0.5</mn></msup></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>G</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>≈</mo><mfrac><mrow><mn>0.03</mn><mo>+</mo><mn>0.23</mn><mo>+</mo><mn>0.21</mn><mo>+</mo><mn>0.26</mn><mo>+</mo><mn>0.49</mn><mo>+</mo><mn>0.08</mn><mo>+</mo><mn>0.27</mn><mo>+</mo><mn>0.13</mn></mrow><mrow><mn>0.21</mn><mo>+</mo><mn>0.23</mn><mo>+</mo><mn>0.21</mn><mo>+</mo><mn>0.26</mn><mo>+</mo><mn>0.77</mn><mo>+</mo><mn>0.58</mn><mo>+</mo><mn>0.60</mn><mo>+</mo><mn>0.13</mn></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>G</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1.701419</mn><mn>2.986235</mn></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>G</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>0.569754</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}

G &amp;= \displaystyle \frac
  {\sum_{i = 1}^{n} L_i(\frac{A_i}{A_T} + \frac{B_i}{B_T})^{0.5}
    |\displaystyle \frac
      {\frac{A_i}{A_T} - \frac{B_i}{B_T}}
      {\frac{A_i}{A_T} + \frac{B_i}{B_T}} |}
  {\sum_{i = 1}^{n} L_i(\frac{A_i}{A_T} + \frac{B_i}{B_T})^{0.5}}  \\ \\

G &amp;= \displaystyle \frac
  {
    L_1(\frac{A_1}{A_T} + \frac{B_1}{B_T})^{0.5}
      |\displaystyle \frac
        {\frac{A_1}{A_T} - \frac{B_1}{B_T}}
        {\frac{A_1}{A_T} + \frac{B_1}{B_T}}| + 
    \cdots + 
    L_n(\frac{A_n}{A_T} + \frac{B_n}{B_T})^{0.5}
      |\displaystyle \frac
        {\frac{A_n}{A_T} - \frac{B_n}{B_T}}
        {\frac{A_n}{A_T} + \frac{B_n}{B_T}}|
  }{
    L_1(\frac{A_1}{A_T} + \frac{B_1}{B_T})^{0.5} + 
    \cdots + 
    L_n(\frac{A_n}{A_T} + \frac{B_n}{B_T})^{0.5}
  }  
  \\ \\

G &amp;= \displaystyle \frac
  {
    0.2(\frac{9}{15} + \frac{7}{15})^{0.5}
      |\displaystyle \frac
        {\frac{9}{15} - \frac{7}{15}}
        {\frac{9}{15} + \frac{7}{15}}| + 
    \cdots + 
    0.3(\frac{3}{15} + \frac{0}{15})^{0.5}
      |\displaystyle \frac
        {\frac{3}{15} - \frac{0}{15}}
        {\frac{3}{15} + \frac{0}{15}}|
  }{
    0.2(\frac{9}{15} + \frac{7}{15})^{0.5} + 
    \cdots + 
    0.3(\frac{3}{15} + \frac{0}{15})^{0.5}
  }  
  \\ \\
  
G &amp;\approx \displaystyle \frac
  {0.03 + 0.23 + 0.21 + 0.26 + 0.49 + 0.08 + 0.27 + 0.13}
  {0.21 + 0.23 + 0.21 + 0.26 + 0.77 + 0.58 + 0.60+ 0.13}
  \\ \\
  
G &amp;= \displaystyle \frac{1.701419}{2.986235}  \\ \\
G &amp;= 0.569754

\end{align*}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="variance-adjusted">Variance Adjusted<a class="anchor" aria-label="anchor" href="#variance-adjusted"></a>
</h2>
<ul>
<li>
<a href="https://doi.org/10.1186/1471-2105-12-118" class="external-link">Chang et al,
2011</a>: Variance Adjusted Weighted (VAW) UniFrac</li>
<li>R Package <a href="https://doi.org/10.32614/CRAN.package.abdiv" class="external-link">abdiv</a>:
<code>variance_adjusted_unifrac()</code>
</li>
<li>
<a href="https://qiime2.org/" class="external-link">qiime2</a>
<code>qiime diversity beta-phylogenetic --p-metric weighted_normalized_unifrac --p-variance-adjusted</code>
</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>V</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mfrac><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>−</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>T</mi></msub><mo>+</mo><msub><mi>B</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>T</mi></msub><mo>+</mo><msub><mi>B</mi><mi>T</mi></msub><mo>−</mo><msub><mi>A</mi><mi>i</mi></msub><mo>−</mo><msub><mi>B</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>L</mi><mi>i</mi></msub><mfrac><mrow><mfrac><msub><mi>A</mi><mi>i</mi></msub><msub><mi>A</mi><mi>T</mi></msub></mfrac><mo>+</mo><mfrac><msub><mi>B</mi><mi>i</mi></msub><msub><mi>B</mi><mi>T</mi></msub></mfrac></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>T</mi></msub><mo>+</mo><msub><mi>B</mi><mi>T</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>A</mi><mi>T</mi></msub><mo>+</mo><msub><mi>B</mi><mi>T</mi></msub><mo>−</mo><msub><mi>A</mi><mi>i</mi></msub><mo>−</mo><msub><mi>B</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}

V &amp;= \displaystyle \frac
  {\sum_{i = 1}^{n} L_i\displaystyle \frac
    {|\frac{A_i}{A_T} - \frac{B_i}{B_T}|}
    {(A_T + B_T)(A_T + B_T - A_i - B_i)} }
  {\sum_{i = 1}^{n} L_i\displaystyle \frac
    {\frac{A_i}{A_T} + \frac{B_i}{B_T}}
    {(A_T + B_T)(A_T + B_T - A_i - B_i)} }  \\ \\

\end{align*}</annotation></semantics></math></p>
<!--

# Variant W3

\begin{align*}

W3 &= \displaystyle \frac
  {\sum_{i = 1}^{n} L_i|\frac{A_i}{A_T} - \frac{B_i}{B_T}|}
  {\sum_{i = 1}^{n} L_i(A_i + B_i)}
  \\ \\
  
W3 &= \displaystyle \frac
  {L_1|\frac{A_1}{A_T} - \frac{B_1}{B_T}| + L_2|\frac{A_2}{A_T} - \frac{B_2}{B_T}| + \cdots + L_n|\frac{A_n}{A_T} - \frac{B_n}{B_T}|}
  {L_1(A_1 + B_1) + L_2(A_2 + B_2) + \cdots + L_n(A_n + B_n)}
  \\ \\
  
W3 &= \displaystyle \frac
  {0.2|\frac{9}{15} - \frac{7}{15}| + 0.4|\frac{0}{15} - \frac{5}{15}| + \cdots + 0.3|\frac{3}{15} - \frac{0}{15}|}
  {0.2(9 + 7) + 0.4(0 + 5) + \cdots + 0.3(3 + 0)}
  \\ \\
  
W3 &= \displaystyle \frac
  {0.02\overline{6} + 0.1\overline{3} + 0.05\overline{3} + 0.1\overline{3} + 0.42 + 0.08 + 0.2\overline{3} + 0.06}
  {3.2 + 2 + 0.8 + 2 + 9.9 + 8.4 + 7.7 + 0.9}
  \\ \\
  
W3 &= \displaystyle \frac{1.14}{34.9}  \\ \\
W3 &= 0.03266476
\end{align*}



# Variant W4

\begin{align*}

W4 &= \displaystyle \frac
  {\sum_{i = 1}^{n} L_i|\frac{A_i}{A_T} - \frac{B_i}{B_T}|}
  {\sum_{i = 1}^{n} L_i}
  \\ \\
  
W4 &= \displaystyle \frac
  {L_1|\frac{A_1}{A_T} - \frac{B_1}{B_T}| + L_2|\frac{A_2}{A_T} - \frac{B_2}{B_T}| + \cdots + L_n|\frac{A_n}{A_T} - \frac{B_n}{B_T}|}
  {L_1 + L_2 + \cdots + L_n}
  \\ \\
  
W4 &= \displaystyle \frac
  {0.2|\frac{9}{15} - \frac{7}{15}| + 0.4|\frac{0}{15} - \frac{5}{15}| + \cdots + 0.3|\frac{3}{15} - \frac{0}{15}|}
  {0.2 + 0.4 + \cdots + 0.3}
  \\ \\
  
W4 &= \displaystyle \frac
  {0.02\overline{6} + 0.1\overline{3} + 0.05\overline{3} + 0.1\overline{3} + 0.42 + 0.08 + 0.2\overline{3} + 0.06}
  {0.2 + 0.4 + 0.8 + 0.5 + 0.9 + 0.6 + 0.7 + 0.3}
  \\ \\
  
W4 &= \displaystyle \frac{1.14}{4.4}  \\ \\
W4 &= 0.2590909
\end{align*}

-->
<!---

# Software Testing

## Files


``` r
tmp <- normalizePath(tempdir(), winslash = '/')
cat(tmp) # C:/Users/Daniel/AppData/Local/Temp/RtmpcNccFS

biom_fp <- file.path(tmp, 'ex.biom')
tree_fp <- file.path(tmp, 'ex.tree')
mothur_shared <- file.path(tmp, 'ex.shared')
mothur_counts <- file.path(tmp, 'ex.counts')

cat(
  file = biom_fp, sep = '',
  '#OTU ID\tSample_1\tSample_2\n',
  sprintf('OTU_%i\t%i\t%i\n', 1:5, c(0,0,9,3,3), c(1,4,2,8,0))  )

cat(
  file = tree_fp, 
  '(((OTU_1:0.8,OTU_2:0.5):0.4,OTU_3:0.9):0.2,(OTU_4:0.7,OTU_5:0.3):0.6);\n' )

cat(
  file = mothur_shared, sep = '',
  'label\tGroup\tnumOtus\tOTU_1\tOTU_2\tOTU_3\tOTU_4\tOTU_5\n',
  '1\tSample_1\t5\t0\t0\t9\t3\t3\n',
  '1\tSample_2\t5\t1\t4\t2\t8\t0\n' )

cat(
  file = mothur_counts, sep = '',
  'Representative_Sequence\ttotal\tSample_1\tSample_2\n',
  'OTU_1\t1\t0\t1\n',
  'OTU_2\t4\t0\t4\n',
  'OTU_3\t11\t9\t2\n',
  'OTU_4\t11\t3\t8\n',
  'OTU_5\t3\t3\t0\n' )
```






``` r
packageDate('phyloseq') # 2021-11-29

mtx <- read.table(biom_fp, sep = '\t', row.names = 1, header = TRUE, comment.char = '')

physeq <- phyloseq::merge_phyloseq(
  phyloseq::otu_table(mtx, taxa_are_rows = TRUE), 
  phyloseq::read_tree(tree_fp) )

phyloseq::UniFrac(physeq, weighted=FALSE, normalized=TRUE)  # 0.4545455
phyloseq::UniFrac(physeq, weighted=FALSE, normalized=FALSE) # 0.4545455
phyloseq::UniFrac(physeq, weighted=TRUE,  normalized=FALSE) # 1.14
phyloseq::UniFrac(physeq, weighted=TRUE,  normalized=TRUE)  # 0.4899713
```



``` r
x <- as.vector(mtx['Sample_1',])
y <- as.vector(mtx['Sample_2',])

abdiv::unweighted_unifrac(x, y, phy)          # 0.4545455
abdiv::weighted_unifrac(x, y, phy)            # 1.14
abdiv::weighted_normalized_unifrac(x, y, phy) # 0.4899713
abdiv::variance_adjusted_unifrac(x, y, phy)   # 0.5383505
abdiv::generalized_unifrac(x, y, phy)         # 0.569754
abdiv::information_unifrac(x, y, phy)         # 0.1444812
abdiv::phylosor(x, y, phy)                    # 0.2941176
```



``` bash
docker pull quay.io/qiime2/amplicon:2024.10
docker run -t -i -v /c/Users/Daniel/AppData/Local/Temp/RtmpUFKImC:/data quay.io/qiime2/amplicon:2024.10

biom convert -i ex.biom -o ex.hdf5 --to-hdf5

# `qiime diversity beta-phylogenetic` uses `ssu` under the hood

ssu -i ex.hdf5 -t ex.tree -m unweighted            -o uu.dm # 0.4545454382896423
ssu -i ex.hdf5 -t ex.tree -m weighted_normalized   -o wn.dm # 0.4899713099002838
ssu -i ex.hdf5 -t ex.tree -m weighted_unnormalized -o wu.dm # 1.139999985694885
ssu -i ex.hdf5 -t ex.tree -m generalized -a 0.5    -o gu.dm # 0.5697539448738098
```



``` powershell
# Using https://github.com/mothur/mothur/releases/download/v1.48.2/Mothur.win.zip
.\mothur.exe

unifrac.unweighted(tree=ex.tree, count=ex.counts) # 0.454545
unifrac.weighted(tree=ex.tree, count=ex.counts)   # 0.489971
```


--->
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel P. Smith, Alkek Center for Metagenomics and Microbiome Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
