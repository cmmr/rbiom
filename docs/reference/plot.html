<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Visualize BIOM data. — plot • rbiom</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Visualize BIOM data. — plot"><meta property="og:description" content="Provide two terms to plot() and it will automatically produce the
appropriate chart type. The terms that plot understands and valid
combinations are listed in the Details section. Not all parameters are used
by all chart types."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rbiom</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3.9050</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cmmr/rbiom/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualize BIOM data.</h1>
    <small class="dont-index">Source: <a href="https://github.com/cmmr/rbiom/blob/HEAD/R/plot.r" class="external-link"><code>R/plot.r</code></a></small>
    <div class="hidden name"><code>plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provide two terms to <code>plot()</code> and it will automatically produce the
appropriate chart type. The terms that <code>plot</code> understands and valid
combinations are listed in the Details section. Not all parameters are used
by all chart types.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S3 method for BIOM</span>
<span class="fu">plot</span><span class="op">(</span>
  <span class="va">x</span>,
  <span class="va">formula</span>,
  layers <span class="op">=</span> <span class="st">"rls"</span>,
  color.by <span class="op">=</span> <span class="cn">NULL</span>,
  pattern.by <span class="op">=</span> <span class="cn">NULL</span>,
  shape.by <span class="op">=</span> <span class="cn">NULL</span>,
  label.by <span class="op">=</span> <span class="cn">NULL</span>,
  sort.by <span class="op">=</span> <span class="cn">NULL</span>,
  facet.by <span class="op">=</span> <span class="cn">NULL</span>,
  xvals <span class="op">=</span> <span class="cn">NULL</span>,
  colors <span class="op">=</span> <span class="cn">NULL</span>,
  patterns <span class="op">=</span> <span class="cn">NULL</span>,
  shapes <span class="op">=</span> <span class="cn">NULL</span>,
  facets <span class="op">=</span> <span class="cn">NULL</span>,
  rank <span class="op">=</span> <span class="cn">NULL</span>,
  taxa <span class="op">=</span> <span class="cn">NULL</span>,
  p.top <span class="op">=</span> <span class="cn">Inf</span>,
  p.adj <span class="op">=</span> <span class="st">"fdr"</span>,
  p.label <span class="op">=</span> <span class="fl">0.05</span>,
  perms <span class="op">=</span> <span class="fl">1000</span>,
  ci <span class="op">=</span> <span class="fl">95</span>,
  rline <span class="op">=</span> <span class="cn">NULL</span>,
  xlab.angle <span class="op">=</span> <span class="st">"auto"</span>,
  weighted <span class="op">=</span> <span class="cn">TRUE</span>,
  abbr <span class="op">=</span> <span class="cn">TRUE</span>,
  other <span class="op">=</span> <span class="cn">FALSE</span>,
  gradient <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
  normalize.rows <span class="op">=</span> <span class="cn">TRUE</span>,
  dist <span class="op">=</span> <span class="st">"euclidean"</span>,
  model <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,
  regr <span class="op">=</span> <span class="va">lm</span>,
  safe <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A BIOM object, as returned from <a href="read.biom.html">read.biom</a>.</p></dd>
<dt>formula</dt>
<dd><p>Combination of terms to plot, either in <code>y ~ x</code> or
<code>c("x", "y")</code> form.</p></dd>
<dt>layers</dt>
<dd><p>See "Layers" section for details. Options for super box
plots are <b>box</b>, <b>bar</b> (r), <b>violin</b>, <b>dot</b>,
<b>strip</b>, <b>crossbar</b>, <b>errorbar</b>, <b>linerange</b>, and
<b>pointrange</b>. Options for ordination plots are: <b>point</b>,
<b>spider</b>, <b>ellipse</b>, and <b>name</b> for samples,
and <b>mean</b>, <b>taxon</b>, and <b>arrow</b> for taxa biplots.
Single letter abbreviations are also accepted. For instance,
<code>c("box", "dot")</code> is equivalent to <code>c("b", "d")</code> and
<code>"bd"</code>. Default: "rls" for super box plots and "pce"/"p" for
ordinations with/without a <code>color.by</code> argument.</p></dd>
<dt>color.by, pattern.by, shape.by, label.by, sort.by, facet.by</dt>
<dd><p>Metadata
column to color, pattern, shape, label, sort, and/or facet by. If
that column is a <code>factor</code>, the ordering of levels will be
maintained in the plot.</p></dd>
<dt>colors, patterns, shapes, facets, xvals</dt>
<dd><p>Names of the colors, patterns,
shapes, facets, and/or x values to use in the plot. Available values
for colors, patterns, and shapes are given by <code><a href="https://rdrr.io/r/grDevices/colors.html" class="external-link">colors()</a></code>,
<code><a href="https://trevorldavis.com/R/gridpattern/reference/grid.pattern_magick.html" class="external-link">gridpattern::names_magick</a></code>, and <code>0:25</code>,
respectively. Use a named character vector to map them  to specific
factor levels in the metadata. <code>facets</code> and <code>xvals</code> are
coerced to unnamed character vectors. If the length of these vectors
is less than the values present in their corresponding metadata
column, then the data set will be subseted accordingly.</p></dd>
<dt>rank</dt>
<dd><p>What rank of taxa to display. E.g. "Phylum", "Genus", etc. Run
<code><a href="taxa.ranks.html">taxa.ranks()</a></code> to see all options for a given BIOM object. The
default, <code>NULL</code>, selects the lowest level.</p></dd>
<dt>taxa</dt>
<dd><p>Which taxa to display. An integer value will show the top n
most abundant taxa. A value 0 &lt;= n &lt; 1 will show any taxa with that
mean abundance or greater (e.g. 0.1). A character vector of
taxon names will show only those taxa. (Default: <code>10</code> for
heatmaps, <code>5</code> otherwise.)</p></dd>
<dt>p.top</dt>
<dd><p>For <code>RANK ~ .</code> (taxa abundance) plots or
<code>BDIV ~ ORD</code> ordination biplots, only display taxa with the most
significant differences in abundance. If <code>p.top</code> is &gt;= 1, then
the <code>p.top</code> most significant taxa are displayed. If <code>p.top</code>
is less than one, all taxa with an adjusted p-value &lt;= <code>p.top</code>
are displayed. Recommended to be used in combination with the
<code>taxa</code> parameter to set a lower bound on the mean abundance of
considered taxa. (Default: <code>Inf</code>)</p></dd>
<dt>p.adj</dt>
<dd><p>Method to use for multiple comparisons adjustment of p-values.
Run <code>p.adjust.methods</code> for a list of available options.
(Default: <code>fdr</code>)</p></dd>
<dt>p.label</dt>
<dd><p>Minimum adjusted p-value to display on the plot with a bracket.
Set to <code>Inf</code> to display all p-values, or <code>-Inf</code> for no brackets.
If a numeric vector with more than one value is provided, they will be
used as breaks for asterisk notation. For ordinations, <code>p.label</code>
applies to biplot taxa. (Default: <code>0.05</code>)</p></dd>
<dt>perms</dt>
<dd><p>Number of random permutations to use for estimating statistical
significance in <code>BDIV ~ ORD</code> ordinations. (Default: <code>1000</code>)</p></dd>
<dt>ci</dt>
<dd><p>How to calculate min/max of the <b>crossbar</b>,
<b>errorbar</b>, <b>linerange</b>, and <b>pointrange</b> layers.
Provide a number between 75 and 100 to define a confidence interval's
confidence level, commonly 95 or 97.5. Other options are:
<b>range</b>,
<b>sd</b> (standard deviation),
<b>se</b> (standard error), and
<b>mad</b> (median absolute deviation).
The center mark of <code>crossbar</code> and <code>pointrange</code> represents
the mean, except for <b>mad</b> in which case it represents
the median. Trendlines require a confidence interval value.
Set to <code>NULL</code> to disable. Default: <code>95</code></p></dd>
<dt>rline</dt>
<dd><p>On rarefaction plots, highlight this rarefaction depth with a
dashed line. (Default: NULL)</p></dd>
<dt>xlab.angle</dt>
<dd><p>How to rotate the tick labels on the x-axis.
<b>'auto'</b> (the default), automatically selects a rotation value.
<b>0</b>, <b>30</b>, and <b>90</b> sets the angle to horizontal,
angled, and vertical, respectively.</p></dd>
<dt>weighted</dt>
<dd><p>When employing a beta diversity metric, use the weighted
version. (Default: <code>TRUE</code>)</p></dd>
<dt>abbr</dt>
<dd><p>When selecting taxa by name, allow abbreviated 'taxa' values,
e.g. <code>c('staph', 'lact')</code>. (Default: TRUE).</p></dd>
<dt>other</dt>
<dd><p>Should non-selected taxa be displayed as an "Other" group?
(Default: <code>FALSE</code>)</p></dd>
<dt>gradient</dt>
<dd><p>For heatmaps, the color gradient to use for the cells.
(Default: <code>heat.colors(20)</code>)</p></dd>
<dt>normalize.rows</dt>
<dd><p>For heatmaps, should each row (taxon) have its
values rescaled from min-max to 0-1. (Default: <code>TRUE</code>)</p></dd>
<dt>dist</dt>
<dd><p>For <code>RANK ~ CLUST</code>, the distance metric to use.
(Default: <code>"euclidean"</code>)</p></dd>
<dt>model</dt>
<dd><p>For regressions, the formula to use in the smoothing function.
For example: <code>y ~ x</code>, <code>y ~ log(x)</code>, or <code>y ~ poly(x,2)</code>.
(Default: <code>y ~ x</code>)</p></dd>
<dt>regr</dt>
<dd><p>For <code>BDIV ~ ORD</code>, the number of random permutations to
use when calculating adonis statistics. (Default: <code>999</code>)</p></dd>
<dt>safe</dt>
<dd><p>If <code>FALSE</code>, data.frame column names such as
<code>".metric"</code> will be auto-converted to <code>"Metric"</code> to improve
human-readability. Conversion if aborted if a conflict is found with
a metadata column name. (Default: <code>FALSE</code>)</p></dd>
<dt>...</dt>
<dd><p>Parameters for underlying functions.
See "Additional Parameters" section for details.
For heatmaps, <code>...</code> is handled by <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap::pheatmap()</a></code>.
Otherwise, parameters are matched to formal arguments of ggplot2
functions. Prefixing parameter names with a layer name ensures that
a particular parameter is passed to, and only to, that layer. For
instance, <code>dot.size = 2</code> or <code>d.size = 2</code> ensures only the
dotplot layer has its size set to <code>2</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>ggplot2</code> plot. The computed data points and statistics will
be attached as <code>attr(p, 'data')</code> and <code>attr(p, 'stats')</code>,
respectively.
Shapes can also be given as their string values, defined in pch_table here:
https://github.com/tidyverse/ggplot2/blob/master/R/geom-point.r . Note that
some shapes have a colored outline given by <code>color</code>, some are filled with
<code>color</code>, and some are outlined in <code>color</code> and filled with <code>fill</code>. See
https://blog.albertkuo.me/post/point-shape-options-in-ggplot/ for details.
To expand the low end of the y axis, you can set <code>y.trans = "sqrt"</code> or
<code>y.trans = "log1p"</code>. The former applies a square-root transformation,
and the latter plots log(y + 1). Both of these methods work well with data
that contains zeroes.</p>
    </div>
    <div id="terms">
    <h2>Terms</h2>
    

<p>Terms come in the nine categories given below. The values are
case-insensitive and can be unambiguously abbreviated.</p><ul><li><p><b>Ordination Method (ORD): </b>
<code>PCoA</code>, <code>tSNE</code>, or <code>NMDS</code>.</p></li>
<li><p><b>Alpha Diversity Metric (ADIV): </b>
<code>OTUs</code>, <code>Shannon</code>, <code>Chao1</code>, <code>Simpson</code>,
and <code>InvSimpson</code>. Multiple allowed.</p></li>
<li><p><b>Beta Diversity Metric (BDIV): </b>
<code>Manhattan</code>, <code>Euclidean</code>, <code>Bray-Curtis</code>, <code>Jaccard</code>,
or <code>UniFrac</code>.</p></li>
<li><p><b>Distance Formula (DIST): </b>
<code>correlation</code>, <code>euclidean</code>, <code>maximum</code>, <code>manhattan</code>,
<code>canberra</code>, <code>binary</code>, or <code>minkowski</code>.</p></li>
<li><p><b>Taxonomic Rank (RANK): </b>
<code>Kingdom</code>, <code>Phylum</code>, <code>Class</code>, <code>Order</code>,
<code>Family</code>, <code>Genus</code>, <code>Species</code>, <code>Strain</code>, and
<code>OTU</code>. Multiple allowed. Supported ranks will vary by BIOM. Run
<code>taxa.ranks(biom)</code> to see the available options.</p></li>
<li><p><b>Individual Taxon (TAXON): </b>
The name of a taxon from the BIOM's <code><a href="taxonomy.html">taxonomy()</a></code>.
For instance, <code>Firmicutes</code> or <code>Prevotella</code>.</p></li>
<li><p><b>Metadata (FACTOR or NUMERIC): </b>
The name of a column from the BIOM's <code><a href="metadata.html">metadata()</a></code>.
For instance, <code>`Body Site`</code> or <code>Age</code>.</p></li>
<li><p><b>Clustering Method (CLUST): </b>
<code>average</code>, <code>ward</code>, <code>mcquitty</code>, <code>single</code>,
<code>median</code>, <code>complete</code>, or <code>centroid</code>. The following
aliases are also understood: <code>heatmap</code> = <code>complete</code>,
<code>UPGMA</code> = <code>average</code>, <code>WPGMA</code> = <code>mcquitty</code>,
<code>WPGMC</code> = <code>median</code>, and <code>UPGMC</code> = <code>centroid</code>.</p></li>
<li><p><b>Special: </b>
<code>Rarefied</code>, <code>Reads</code>, <code>Samples</code>, <code>.</code>, <code>stacked</code></p></li>
</ul></div>
    <div id="term-combinations">
    <h2>Term Combinations</h2>
    
<table class="table table"><tr><td>Combination</td><td>Chart Type</td><td>Example</td></tr><tr><td>ADIV ~ .</td><td>Box Plot</td><td><code>plot(hmp50, Shannon ~ .)          </code></td></tr><tr><td>ADIV ~ FACTOR</td><td>Box Plot</td><td><code>plot(hmp50, Shannon ~ `Body Site`)</code></td></tr><tr><td>BDIV ~ FACTOR</td><td>Box Plot</td><td><code>plot(hmp50, Bray ~ Sex)           </code></td></tr><tr><td>RANK ~ .</td><td>Box Plot</td><td><code>plot(hmp50, Phylum ~ .)           </code></td></tr><tr><td>TAXON ~ FACTOR</td><td>Box Plot</td><td><code>plot(hmp50, Firmicutes ~ Sex)     </code></td></tr><tr><td>ADIV ~ NUMERIC</td><td>Scatter Plot</td><td><code>plot(hmp50, Shannon ~ Age)        </code></td></tr><tr><td>ADIV ~ ADIV</td><td>Scatter Plot</td><td><code>plot(hmp50, Depth ~ OTUs)         </code></td></tr><tr><td>TAXON ~ NUMERIC</td><td>Scatter Plot</td><td><code>plot(hmp50, Prevoltella ~ BMI)    </code></td></tr><tr><td>BDIV ~ CLUST</td><td>Heatmap</td><td><code>plot(hmp50, UniFrac ~ ward)       </code></td></tr><tr><td>RANK ~ CLUST</td><td>Heatmap</td><td><code>plot(hmp50, Genus ~ heatmap)      </code></td></tr><tr><td>BDIV ~ ORD</td><td>Ordination</td><td><code>plot(hmp50, Bray ~ NMDS)          </code></td></tr><tr><td>RANK ~ stacked</td><td>Stacked bar</td><td><code>plot(hmp50, Family ~ stacked)     </code></td></tr><tr><td>Rarefied ~ Reads</td><td>Rarefaction</td><td><code>plot(hmp50, Rarefied ~ Reads)     </code></td></tr><tr><td>Rarefied ~ Samples</td><td>Rarefaction</td><td><code>plot(hmp50, Rarefied ~ Samples)   </code></td></tr><tr><td>Rarefied ~ ADIV</td><td>Rarefaction</td><td><code>plot(hmp50, Rarefied ~ Shannon)   </code></td></tr></table></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="stats.table.html">stats.table</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cmmr.github.io/rbiom/index.html" class="external-link">rbiom</a></span><span class="op">)</span></span>
<span class="r-in">    </span>
<span class="r-in">    <span class="va">biom</span> <span class="op">&lt;-</span> <span class="fu"><a href="rarefy.html">rarefy</a></span><span class="op">(</span><span class="va">hmp50</span><span class="op">)</span></span>
<span class="r-in">    </span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="va">Shannon</span> <span class="op">~</span> <span class="va">`Body Site`</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in x[floor(d)] + x[ceiling(d)]:</span> non-numeric argument to binary operator</span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">OTUs</span>, <span class="va">Shannon</span><span class="op">)</span> <span class="op">~</span> <span class="va">Sex</span>, layers<span class="op">=</span><span class="st">"vb"</span>, color.by<span class="op">=</span><span class="st">"Body Site"</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in x[floor(d)] + x[ceiling(d)]:</span> non-numeric argument to binary operator</span>
<span class="r-in">    </span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="va">Simpson</span> <span class="op">~</span> <span class="va">`Body Site`</span>, layers<span class="op">=</span><span class="st">"p"</span>, color.by<span class="op">=</span><span class="st">"Sex"</span>, xlab.angle<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in x[floor(d)] + x[ceiling(d)]:</span> non-numeric argument to binary operator</span>
<span class="r-in">    </span>
<span class="r-in">    <span class="co"># Ordination</span></span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="va">bray</span> <span class="op">~</span> <span class="va">nmds</span>, color.by<span class="op">=</span><span class="st">"Body Site"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot-1.png" alt="" width="700" height="433"></span>
<span class="r-in">    </span>
<span class="r-in">    <span class="co"># Dissimilarity boxplots</span></span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="va">UniFrac</span> <span class="op">~</span> <span class="va">`==Body Site`</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in x[floor(d)] + x[ceiling(d)]:</span> non-numeric argument to binary operator</span>
<span class="r-in">    </span>
<span class="r-in">    <span class="co"># Dissimilarity Heatmap</span></span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="va">UniFrac</span> <span class="op">~</span> <span class="va">heatmap</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot-2.png" alt="" width="700" height="433"></span>
<span class="r-in">    </span>
<span class="r-in">    <span class="co"># Taxa abundance boxplots</span></span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Phylum</span>, <span class="va">Genus</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in (function (x, formula, layers = "rls", color.by = NULL, pattern.by = NULL,     shape.by = NULL, label.by = NULL, sort.by = NULL, facet.by = NULL,     xvals = NULL, colors = NULL, patterns = NULL, shapes = NULL,     facets = NULL, rank = NULL, taxa = NULL, p.top = Inf, p.adj = "fdr",     p.label = 0.05, perms = 1000, ci = 95, rline = NULL, xlab.angle = "auto",     weighted = TRUE, abbr = TRUE, other = FALSE, gradient = heat.colors(20),     normalize.rows = TRUE, dist = "euclidean", model = y ~ x,     regr = lm, safe = FALSE, ...) {    all_args &lt;- intersect(names(formals(plot.BIOM)), names(match.call()))    all_args &lt;- sapply(all_args, function(i) get(i))    all_args &lt;- c(all_args, list(...))    history &lt;- sprintf("plot(%s)", as.args(all_args, fun = plot.BIOM))    remove("all_args")    biom &lt;- x    if (!is(biom, "BIOM"))         stop("Please provide a BIOM object.")    params &lt;- list(xval.by = as.vector(x), color.by = color.by,         pattern.by = pattern.by, shape.by = shape.by, label.by = label.by,         sort.by = sort.by, facet.by = facet.by, xvals = xvals,         colors = colors, patterns = patterns, shapes = shapes,         facets = facets, rank = rank, taxa = taxa, p.top = p.top,         p.adj = p.adj, p.label = p.label, perms = perms, ci = ci,         rline = rline, xlab.angle = xlab.angle, weighted = weighted,         abbr = abbr, other = other, gradient = gradient, normalize.rows = normalize.rows,         dist = dist, model = model, regr = regr, safe = safe,         ...)    parsed &lt;- parse_formula(biom, formula, .x = params[[".x"]],         .y = params[[".y"]])    x &lt;- parsed[["x"]]    y &lt;- parsed[["y"]]    mode &lt;- parsed[["mode"]]    if (identical(x, ".")) {        x &lt;- ".all"        biom$metadata[[".all"]] &lt;- ".all"    }    fun &lt;- if (mode == "Rarefied ~ Reads") {        plot_rarefied    }    else if (mode == "Rarefied ~ Samples") {        plot_rarefied    }    else if (mode == "Rarefied ~ adiv") {        plot_rarefied    }    else if (mode == "adiv ~ .") {        boxplot    }    else if (mode == "adiv ~ factor") {        boxplot    }    else if (mode == "adiv ~ numeric") {        plot_numeric    }    else if (mode == "adiv ~ adiv") {        plot_numeric    }    else if (mode == "bdiv ~ ord") {        ordination_plot    }    else if (mode == "bdiv ~ factor") {        boxplot    }    else if (mode == "bdiv ~ clust") {        plot_heatmap    }    else if (mode == "rank ~ .") {        boxplot    }    else if (mode == "rank ~ stacked") {        plot_stacked    }    else if (mode == "rank ~ clust") {        plot_heatmap    }    else if (mode == "taxon ~ factor") {        boxplot    }    else if (mode == "taxon ~ numeric") {        plot_numeric    }    else {        stop("Invalid formula of form '", mode, "'")    }    p &lt;- fun(biom = biom, x = x, y = y, layers = layers, mode = mode,         params = params)    if (interactive() &amp;&amp; !is.null(attr(p, "err", exact = TRUE)))         warning(attr(p, "err", exact = TRUE), call. = FALSE)    attr(p, "history") &lt;- c(attr(biom, "history"), history)    return(p)})(x = biom, formula = c(Phylum, Genus) ~ .):</span> Invalid formula of form 'rank ~ factor'</span>
<span class="r-in">    </span>
<span class="r-in">    <span class="co"># Taxa stacked abundance</span></span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="va">Phylum</span> <span class="op">~</span> <span class="va">stacked</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in assign_colors(colors, df[[".taxa"]]):</span> could not find function "assign_colors"</span>
<span class="r-in">    </span>
<span class="r-in">    <span class="co"># Taxa abundance heatmap</span></span>
<span class="r-in">    <span class="fu">plot</span><span class="op">(</span><span class="va">biom</span>, <span class="va">Phylum</span> <span class="op">~</span> <span class="va">heatmap</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot-3.png" alt="" width="700" height="433"></span>
<span class="r-in">    </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel P. Smith.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

