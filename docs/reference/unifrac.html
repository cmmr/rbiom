<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute Weighted and Unweighted UniFrac distance matrices. — unifrac • rbiom</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Compute Weighted and Unweighted UniFrac distance matrices. — unifrac" />

<meta property="og:description" content="This is the function called internally by beta.div, but is made
visible here so you can use it with matrices and trees without having to
first convert them to BIOM objects." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rbiom</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cmmr/rbiom">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Weighted and Unweighted UniFrac distance matrices.</h1>
    <small class="dont-index">Source: <a href='https://github.com/cmmr/rbiom/blob/master/R/unifrac.r'><code>R/unifrac.r</code></a></small>
    <div class="hidden name"><code>unifrac.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This is the function called internally by <a href='beta.div.html'>beta.div</a>, but is made
visible here so you can use it with matrices and trees without having to
first convert them to <code>BIOM</code> objects.</p>
    
    </div>

    <pre class="usage"><span class='fu'>unifrac</span>(<span class='no'>biom</span>, <span class='kw'>weighted</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>tree</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>progressbar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>biom</th>
      <td><p>A <code>matrix</code>, <code>simple_triplet_matrix</code>, or <code>BIOM</code> 
object, as returned from <a href='read.biom.html'>read.biom</a>. For matrices, the rows and 
columns are assumed to be the taxa and samples, respectively.</p></td>
    </tr>
    <tr>
      <th>weighted</th>
      <td><p>Use weighted UniFrac, which takes abundance into account
rather than simply presence/absence.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>A <code>phylo</code> object providing a phylogenetic tree for the
taxa names in <code>biom</code>. If <code>tree=NULL</code>, then the tree will be
loaded from <code>biom</code>, if encoded there.</p></td>
    </tr>
    <tr>
      <th>progressbar</th>
      <td><p>An object of class <code>Progress</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A distance matrix of class <code>dist</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>    <span class='fu'>library</span>(<span class='no'>rbiom</span>)

    <span class='no'>infile</span> <span class='kw'>&lt;-</span> <span class='fu'>system.file</span>(<span class='st'>"extdata"</span>, <span class='st'>"hmp50.biom"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"rbiom"</span>)
    <span class='no'>biom</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read.biom.html'>read.biom</a></span>(<span class='no'>infile</span>)
    <span class='no'>biom</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='select.html'>select</a></span>(<span class='no'>biom</span>, <span class='fl'>1</span>:<span class='fl'>10</span>)

    <span class='no'>dm</span> <span class='kw'>&lt;-</span> <span class='fu'>unifrac</span>(<span class='no'>biom</span>)
    <span class='fu'>plot</span>(<span class='fu'>hclust</span>(<span class='no'>dm</span>), <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>.8</span>)</div><div class='img'><img src='unifrac-1.png' alt='' width='700' height='433' /></div><div class='input'>    <span class='fu'>as.matrix</span>(<span class='no'>dm</span>)[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>1</span>:<span class='fl'>4</span>]</div><div class='output co'>#&gt;           HMP01     HMP02     HMP03     HMP04
#&gt; HMP01 0.0000000 0.5714029 0.7262758 0.9639771
#&gt; HMP02 0.5714029 0.0000000 0.3435511 0.5693744
#&gt; HMP03 0.7262758 0.3435511 0.0000000 0.2639387
#&gt; HMP04 0.9639771 0.5693744 0.2639387 0.0000000</div><div class='input'>
    <span class='co'># Using a custom matrix and tree</span>
    <span class='no'>mtx</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>sample.int</span>(<span class='fl'>12</span>*<span class='fl'>20</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>20</span>)
    <span class='fu'>dimnames</span>(<span class='no'>mtx</span>) <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='no'>LETTERS</span>[<span class='fl'>1</span>:<span class='fl'>12</span>], <span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>20</span>])
    <span class='no'>tree</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>ape</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/ape/topics/as.phylo'>as.phylo</a></span>(<span class='fu'>hclust</span>(<span class='fu'>dist</span>(<span class='no'>mtx</span>)))

    <span class='no'>dm</span> <span class='kw'>&lt;-</span> <span class='fu'>unifrac</span>(<span class='no'>mtx</span>, <span class='kw'>tree</span><span class='kw'>=</span><span class='no'>tree</span>)
    <span class='fu'>as.matrix</span>(<span class='no'>dm</span>)[<span class='fl'>1</span>:<span class='fl'>4</span>,<span class='fl'>1</span>:<span class='fl'>4</span>]</div><div class='output co'>#&gt;          a        b        c        d
#&gt; a   0.0000 160.5852 207.3862 155.4818
#&gt; b 160.5852   0.0000 199.9140 145.0543
#&gt; c 207.3862 199.9140   0.0000 113.5140
#&gt; d 155.4818 145.0543 113.5140   0.0000</div><div class='input'>    
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel P. Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

