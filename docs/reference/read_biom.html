<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Extracts counts, metadata, taxonomy, and phylogeny from a biom file."><title>Extracts counts, metadata, taxonomy, and phylogeny from a biom file. — read_biom • rbiom</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Extracts counts, metadata, taxonomy, and phylogeny from a biom file. — read_biom"><meta property="og:description" content="Extracts counts, metadata, taxonomy, and phylogeny from a biom file."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rbiom</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9102</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cmmr/rbiom/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extracts counts, metadata, taxonomy, and phylogeny from a biom file.</h1>
      <small class="dont-index">Source: <a href="https://github.com/cmmr/rbiom/blob/HEAD/R/read_biom.r" class="external-link"><code>R/read_biom.r</code></a></small>
      <div class="d-none name"><code>read_biom.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extracts counts, metadata, taxonomy, and phylogeny from a biom file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_biom</span><span class="op">(</span><span class="va">src</span>, tree <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>src</dt>
<dd><p>Input data as either a file path, URL, or JSON string.
BIOM files can be formatted according to
version 1.0 (JSON) or 2.1 (HDF5)
<a href="http://biom-format.org/documentation/" class="external-link">specifications</a>, or as
classical tabular format. URLs must begin with <code>http://</code>,
<code>https://</code>, <code>ftp://</code>, or <code>ftps://</code>. JSON files must
have <code>{</code> as their first character. Compressed (gzip or bzip2)
BIOM files are also supported. NOTE: to read HDF5 formatted BIOM
files, the BioConductor R package <code>rhdf5</code> must be installed.</p></dd>


<dt>tree</dt>
<dd><p>By default, the tree will be read from the BIOM file specified
in <code>src</code>. Specifying <code>tree=TRUE</code> will do the same, but will
generate an error message if a tree is not present. Setting
<code>tree=FALSE</code> will return an <code>rbiom</code> object without any tree
data. You may also provide a file path, URL, or Newick string to load
that tree data into the returned <code>rbiom</code> object.
Default: <code>"auto"</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An <code>rbiom</code> class object containing the parsed data. This object
can be treated as a list with the following named elements:</p><ul><li><p><code>$counts</code> - 
A numeric <code><a href="https://rdrr.io/pkg/slam/man/matrix.html" class="external-link">slam::simple_triplet_matrix()</a></code> (sparse matrix) of
observation counts. Taxa (OTUs) as rows and samples as columns.
Access or modify using <code><a href="otu_matrix.html">otu_matrix()</a></code>.</p></li>
<li><p><code>$metadata</code> - 
A <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble()</a></code> (data frame) containing any embedded
metadata. Sample IDs are in the <code>.sample</code> column.
Access or modify using <code><a href="sample_metadata.html">sample_metadata()</a></code>.</p></li>
<li><p><code>$taxonomy</code> - 
A <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble()</a></code> (data frame) mapping OTU IDs to taxonomic
clades. Columns are named .otu, Kingdom, Phylum, Class, Order,
Family, Genus, Species, and Strain, or TaxLvl.1, TaxLvl.2, ... ,
TaxLvl.N when more than 8 levels of taxonomy are encoded in the
biom file. Access or modify using <code><a href="otu_taxonomy.html">otu_taxonomy()</a></code>.</p></li>
<li><p><code>$phylogeny</code> - 
An object of class <code>phylo</code> defining the phylogenetic
relationships between the OTUs. Although the official
specification for BIOM only includes phylogenetic trees in BIOM
version 2.1, if an rbiom version 1.0 file includes a
<code>phylogeny</code> entry with newick data, then it will be loaded
here as well. The <span class="pkg">ape</span> package has additional functions for
working with <code>phylo</code> objects. Access or modify using
<code><a href="otu_tree.html">otu_tree()</a></code>.</p></li>
<li><p><code>$sequences</code> - 
A named character vector, where the names are OTU IDs and the
values are the nucleic acid sequences they represent.
These values are not part of the official BIOM specification, but
will be read and written when defined. Access or modify using
<code><a href="otu_sequences.html">otu_sequences()</a></code>.</p></li>
<li><p><code>$info</code> - 
A list of other attributes defined in the BIOM file, such as
<code>id</code>, <code>type</code>, <code>format</code>, <code>format_url</code>,
<code>generated_by</code>, <code>date</code>, <code>matrix_type</code>,
<code>matrix_element_type</code>, <code>comment</code>, and <code>shape</code>.
Access using <code><a href="biom_info.html">biom_info()</a></code>. Access/set with <code><a href="biom_id.html">biom_id()</a></code> or
<code><a href="biom_id.html">biom_comment()</a></code>.</p></li>
</ul><p><code>metadata</code>, <code>taxonomy</code>, and <code>phylogeny</code> are optional
components of the BIOM file specification and therefore will be NULL
or simple placeholders in the returned object when they are not provided
by the BIOM file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cmmr.github.io/rbiom/index.html">rbiom</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">infile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"hmp50.bz2"</span>, package <span class="op">=</span> <span class="st">"rbiom"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">biom</span> <span class="op">&lt;-</span> <span class="fu">read_biom</span><span class="op">(</span><span class="va">infile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Human Microbiome Project - 50 Sample Demo (2023-11-28)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      50 Samples:  (HMP01, HMP02, HMP03, HMP04, HMP05, HM...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     490 Taxa:     (UncO2713, UncO4101, AnmMass2, PreBivi...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       7 Ranks:    (.otu, Kingdom, Phylum, Class, Order, ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5 Metadata: (.sample, Age, BMI, Body Site, and Sex)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Tree:     Present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Taxa Abundances</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="otu_matrix.html">otu_matrix</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          HMP01 HMP02 HMP03 HMP04 HMP05 HMP06 HMP07 HMP08 HMP09 HMP10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> UncO2713     0     0     0     0     0     0     1     0     0     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> UncO4101     1     5     6    18     5    15     0     1     8     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AnmMass2     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PreBivi6     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CprSpeci     0     0     0     0     0     0     0     0     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unc96922     0     0     0     1     2     5     0     1     0     0</span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="otu_taxonomy.html">otu_taxonomy</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kingdom  Phylum         Class          Order            Family     Genus .otu </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Bacteria Bacteroidetes  Bacteroidia    Bacteroidales    Rikenella… Alis… UncO…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Bacteria Firmicutes     Clostridia     Clostridiales    Lachnospi… Lach… UncO…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Bacteria Actinobacteria Actinobacteria Actinomycetales  Actinomyc… Acti… AnmM…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Bacteria Bacteroidetes  Bacteroidia    Bacteroidales    Prevotell… Prev… PreB…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> Bacteria Bacteroidetes  Bacteroidia    Bacteroidales    Porphyrom… Barn… CprS…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> Bacteria Bacteroidetes  Flavobacteriia Flavobacteriales Flavobact… Capn… Unc9…</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Metadata</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="sample_metadata.html">sample_metadata</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .sample   Age   BMI `Body Site`   Sex   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> HMP01      22    20 Buccal mucosa Female</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HMP02      24    23 Buccal mucosa Male  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> HMP03      28    26 Saliva        Male  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> HMP04      25    23 Saliva        Male  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> HMP05      27    24 Buccal mucosa Female</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> HMP06      32    25 Saliva        Male  </span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">biom</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">biom</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">`Body Site`</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Anterior nares Buccal mucosa Mid vagina Saliva Stool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Female              5             5         10      5     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Male                5             5          0      5     5</span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Mean age: %.1f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">biom</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">Age</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Mean age: 27.8"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># Phylogenetic tree</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="otu_tree.html">otu_tree</a></span><span class="op">(</span><span class="va">biom</span><span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="tree_subset.html">tree_subset</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span></span></span>
<span class="r-in"><span>      <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="read_biom-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Daniel P. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

