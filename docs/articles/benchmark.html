<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Benchmark • rbiom</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Benchmark">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rbiom</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmark.html">Benchmark</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Benchmark</h1>
                        <h4 class="author">Daniel Smith, PhD</h4>
            
            <h4 class="date">7/2/2018</h4>
      
      
      <div class="hidden name"><code>benchmark.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">eval =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>Here we will compare rbiom to similar packages by measuring the time taken to complete common operations on a representative dataset.</p>
</div>
<div id="create-test-environment" class="section level2">
<h2 class="hasAnchor">
<a href="#create-test-environment" class="anchor"></a>Create Test Environment</h2>
<p>For our tests, we’ll use a virtual machine on Amazon Web Service’s Elastic Compute Cloud. Specifically: * US-West (Oregon) region * AMI 04d99b45e6d99e48e (<a href="https://s3-us-west-2.amazonaws.com/qiime2-data/distro/core/aws-amis.txt">QIIME 2 Core</a>) * c3.8xlarge instance type (32 virtual CPUs) * 20 GiB General Purpose SSD (GP2) Storage on Root Volume</p>
<p>Both the username and password are ‘qiime2’. On this instance, qiime2 is already configured. The following will download and install rbiom, phyloseq, and usearch as well as the test dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="fu">sudo</span> apt-get install build-essential gfortran libssl-dev unzip</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="bu">export</span> <span class="va">TAR=</span>/bin/tar</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="ex">R</span> -e <span class="st">'source("http://bioconductor.org/biocLite.R"); biocLite(c("phyloseq", "rhdf5"))'</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="ex">R</span> -e <span class="st">'install.packages(c("devtools", "doParallel"), repos="http://cran.us.r-project.org");'</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="ex">R</span> -e <span class="st">'devtools::install_git("https://github.com/cmmr/rbiom.git")'</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="fu">wget</span> https://s3.amazonaws.com/jplab/share/30d/usearch10.0.240</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="fu">chmod</span> a+x usearch10.0.240</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="fu">wget</span> https://raw.githubusercontent.com/cmmr/rbiom/master/vignettes/data/hmp500.biom</a></code></pre></div>
</div>
<div id="prepare-input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-input-data" class="anchor"></a>Prepare input data</h2>
<p>The example data is taken from the publicly available Human Microbiome Project. The master data set contains 4,468 samples with 4,468,000 observations of 1,140 OTUs. These samples have been rarefied to 1000 obervations per sample. The below script will randomly subset the master file to n samples, where n begins at 100 samples and is incremented by 100 all the way to 4,400. This will allow us to see how programs handle inputs of varying sizes.</p>
<div id="american-gut-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#american-gut-dataset" class="anchor"></a>American Gut Dataset</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="fu">wget</span> ftp://ftp.microbio.me/AmericanGut/latest/03-otus.zip</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="fu">unzip</span> -j 03-otus.zip 03-otus/100nt/gg-13_8-97-percent/otu_table.biom</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="fu">unzip</span> -j 03-otus.zip 03-otus/100nt/gg-13_8-97-percent/97_otus.tree</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># RScript for running rbiom</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#---------------------------------------</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="fu">cat</span> <span class="op">&gt;</span> prep_data.r <span class="op">&lt;&lt; EOF</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">library(rbiom)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">dir.create("in")</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">dir.create("out")</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">setwd("in")</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">x &lt;- read.biom("otu_table.biom")</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">x<span class="va">$phylogeny</span> &lt;- read.tree("97_otus.tree")</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">for (nSamples in c(100, 400, 900, 1600, 2500, 3600, 4900, 6400, 8100, 10000)) {</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">  y &lt;- select(x, sample.int(ncol(x<span class="va">$counts</span>), n))</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">  y<span class="va">$taxonomy</span> &lt;- NULL</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  write.biom(y, paste0("ag", n, ".tab"), "tab")</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">  write.tree(y<span class="va">$phylogeny</span>, paste0("ag", n, ".tre"))</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">  cmd &lt;- sprintf('biom convert -i ag%i.tab -o ag%i.json --table-type="OTU table" --to-json', n, n)</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">  system(command = cmd, wait = FALSE, ignore.stdout = TRUE, ignore.stderr = TRUE)</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">  cmd &lt;- sprintf('biom convert -i ag%i.tab -o ag%i.hdf5 --table-type="OTU table" --to-hdf5', n, n)</a>
<a class="sourceLine" id="cb3-25" data-line-number="25">  system(command = cmd, wait = FALSE, ignore.stdout = TRUE, ignore.stderr = TRUE)</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="ex">Rscript</span> prep_data.r</a></code></pre></div>
</div>
</div>
<div id="weighted-unifrac" class="section level2">
<h2 class="hasAnchor">
<a href="#weighted-unifrac" class="anchor"></a>Weighted UniFrac</h2>
<p>Create four scripts, one per program. These scripts will be the minimal steps needs to read in a biom file and newick, compute a distance matrix, then save the results to a tsv file. Each script will accept three arguments: (1) the number of cpu cores to use, (2) a single character ‘w’ or ‘u’ indicating whether to run weighted or unweighted unifrac, and (3) the input file to use in terms of number of samples.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># RScript for running rbiom</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#---------------------------------------</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="fu">cat</span> <span class="op">&gt;</span> rbiom.r <span class="op">&lt;&lt; EOF</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">args &lt;- commandArgs(trailingOnly=TRUE)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">options('rbiom.max.threads' = as.integer(args[1]))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">bFile &lt;- paste0("in/hmp", args[3],".json")</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">tFile &lt;- paste0("in/hmp", args[3],".tre")</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">oFile &lt;- paste0("out/rbiom_", args[2], "_dm", args[3],".tsv")</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">dm &lt;- rbiom::unifrac(</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  biom     = rbiom::read.biom(bFile),</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  tree     = rbiom::read.tree(tFile), </a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  weighted = identical(args[2], 'w') )</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">write.table(as.matrix(dm), oFile, sep="\t", quote=FALSE)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co"># RScript for running phyloseq</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#---------------------------------------</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="fu">cat</span> <span class="op">&gt;</span> phyloseq.r <span class="op">&lt;&lt; EOF</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23">library(methods)</a>
<a class="sourceLine" id="cb4-24" data-line-number="24">args &lt;- commandArgs(trailingOnly=TRUE)</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">cpus &lt;- as.integer(args[1])</a>
<a class="sourceLine" id="cb4-26" data-line-number="26"></a>
<a class="sourceLine" id="cb4-27" data-line-number="27">if (cpus &gt; 1)</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">  doParallel::registerDoParallel(parallel::makePSOCKcluster(cpus))</a>
<a class="sourceLine" id="cb4-29" data-line-number="29"></a>
<a class="sourceLine" id="cb4-30" data-line-number="30">bFile &lt;- paste0("in/hmp", args[3],".json")</a>
<a class="sourceLine" id="cb4-31" data-line-number="31">tFile &lt;- paste0("in/hmp", args[3],".tre")</a>
<a class="sourceLine" id="cb4-32" data-line-number="32">oFile &lt;- paste0("out/phyloseq_", args[2], "_dm", args[3],".tsv")</a>
<a class="sourceLine" id="cb4-33" data-line-number="33"></a>
<a class="sourceLine" id="cb4-34" data-line-number="34">dm &lt;- phyloseq::UniFrac(</a>
<a class="sourceLine" id="cb4-35" data-line-number="35">  phy        = phyloseq::import_biom(bFile, tFile), </a>
<a class="sourceLine" id="cb4-36" data-line-number="36">  weighted   = identical(args[2], 'w'), </a>
<a class="sourceLine" id="cb4-37" data-line-number="37">  parallel   = cpus &gt; 1, </a>
<a class="sourceLine" id="cb4-38" data-line-number="38">  normalized = FALSE )</a>
<a class="sourceLine" id="cb4-39" data-line-number="39">write.table(as.matrix(dm), oFile, sep="\t", quote=FALSE)</a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co"># Shell script for running qiime2</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#---------------------------------------</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="fu">cat</span> <span class="op">&gt;</span> qiime2.sh <span class="op">&lt;&lt; EOF</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46">if [ <span class="dt">\$</span>2 = "u" ]; then metric="unweighted_unifrac"; else metric="weighted_unifrac"; fi</a>
<a class="sourceLine" id="cb4-47" data-line-number="47">qiime tools import --input-path in/hmp<span class="dt">\$</span>3.json --output-path json --type FeatureTable[Frequency] --source-format BIOMV100Format</a>
<a class="sourceLine" id="cb4-48" data-line-number="48">qiime tools import --input-path in/hmp<span class="dt">\$</span>3.tre --output-path tree --type Phylogeny[Rooted] --source-format NewickFormat</a>
<a class="sourceLine" id="cb4-49" data-line-number="49">taskset -c 0-39:2 qiime diversity beta-phylogenetic-alt --i-table json.qza --i-phylogeny tree.qza --p-metric <span class="dt">\$</span>metric --output-dir qiime_out --p-n-jobs <span class="dt">\$</span>1</a>
<a class="sourceLine" id="cb4-50" data-line-number="50">qiime tools export --output-dir qiime_out qiime_out/distance_matrix.qza</a>
<a class="sourceLine" id="cb4-51" data-line-number="51">mv qiime_out/distance-matrix.tsv out/qiime2_<span class="dt">\$</span>2_dm<span class="dt">\$</span>3.tsv</a>
<a class="sourceLine" id="cb4-52" data-line-number="52">rm -rf json.qza tree.qza qiime_out</a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"></a>
<a class="sourceLine" id="cb4-56" data-line-number="56"><span class="co"># Shell script for running ssu</span></a>
<a class="sourceLine" id="cb4-57" data-line-number="57"><span class="co"># https://github.com/biocore/unifrac</span></a>
<a class="sourceLine" id="cb4-58" data-line-number="58"><span class="co">#---------------------------------------</span></a>
<a class="sourceLine" id="cb4-59" data-line-number="59"><span class="fu">cat</span> <span class="op">&gt;</span> ssu.sh <span class="op">&lt;&lt; EOF</span></a>
<a class="sourceLine" id="cb4-60" data-line-number="60">if [ <span class="dt">\$</span>2 = "u" ]; then metric="unweighted"; else metric="weighted_unnormalized"; fi</a>
<a class="sourceLine" id="cb4-61" data-line-number="61">taskset -c 0-39:2 ssu -i in/hmp<span class="dt">\$</span>3.hdf5 -t in/hmp<span class="dt">\$</span>3.tre -m <span class="dt">\$</span>metric -o out/ssu_<span class="dt">\$</span>2_dm<span class="dt">\$</span>3.tsv -n <span class="dt">\$</span>1</a>
<a class="sourceLine" id="cb4-62" data-line-number="62"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63"></a>
<a class="sourceLine" id="cb4-64" data-line-number="64"></a>
<a class="sourceLine" id="cb4-65" data-line-number="65"><span class="co"># Shell script for running usearch</span></a>
<a class="sourceLine" id="cb4-66" data-line-number="66"><span class="co">#---------------------------------------</span></a>
<a class="sourceLine" id="cb4-67" data-line-number="67"><span class="fu">cat</span> <span class="op">&gt;</span> usearch.sh <span class="op">&lt;&lt; EOF</span></a>
<a class="sourceLine" id="cb4-68" data-line-number="68">if [ <span class="dt">\$</span>2 = "u" ]; then metric="unifrac_binary"; else metric="unifrac"; fi</a>
<a class="sourceLine" id="cb4-69" data-line-number="69">./usearch10.0.240 -beta_div in/hmp<span class="dt">\$</span>3.tab -metrics <span class="dt">\$</span>metric -tree in/hmp<span class="dt">\$</span>3.tre -quiet</a>
<a class="sourceLine" id="cb4-70" data-line-number="70">mv <span class="dt">\$</span>metric.txt out/unifrac_<span class="dt">\$</span>2_dm<span class="dt">\$</span>3.tsv</a>
<a class="sourceLine" id="cb4-71" data-line-number="71">rm <span class="dt">\$</span>metric.sorted.txt</a>
<a class="sourceLine" id="cb4-72" data-line-number="72">rm <span class="dt">\$</span>metric.tree</a>
<a class="sourceLine" id="cb4-73" data-line-number="73"><span class="op">EOF</span></a>
<a class="sourceLine" id="cb4-74" data-line-number="74"></a>
<a class="sourceLine" id="cb4-75" data-line-number="75"></a>
<a class="sourceLine" id="cb4-76" data-line-number="76"><span class="co"># Shell script for running mothur</span></a>
<a class="sourceLine" id="cb4-77" data-line-number="77"><span class="co">#---------------------------------------</span></a>
<a class="sourceLine" id="cb4-78" data-line-number="78"><span class="fu">cat</span> <span class="op">&gt;</span> mothur.sh <span class="op">&lt;&lt; EOF1</span></a>
<a class="sourceLine" id="cb4-79" data-line-number="79"></a>
<a class="sourceLine" id="cb4-80" data-line-number="80">if [ <span class="dt">\$</span>2 = "u" ]; then fn="unweighted"; else fn="weighted"; fi</a>
<a class="sourceLine" id="cb4-81" data-line-number="81">if [ <span class="dt">\$</span>2 = "u" ]; then pf="uw";         else pf="tre1.w";   fi</a>
<a class="sourceLine" id="cb4-82" data-line-number="82"></a>
<a class="sourceLine" id="cb4-83" data-line-number="83">cat &gt; mothur<span class="dt">\$\$</span>.bat &lt;&lt; EOF2</a>
<a class="sourceLine" id="cb4-84" data-line-number="84"></a>
<a class="sourceLine" id="cb4-85" data-line-number="85">biom.info(biom=in/hmp<span class="dt">\$</span>{3}.json)</a>
<a class="sourceLine" id="cb4-86" data-line-number="86">count.seqs(shared=in/hmp<span class="dt">\$</span>{3}.userLabel.shared)</a>
<a class="sourceLine" id="cb4-87" data-line-number="87">unifrac.<span class="dt">\$</span>{fn}(tree=in/hmp<span class="dt">\$</span>{3}.tre, processors=<span class="dt">\$</span>{1}, distance=lt, count=in/hmp<span class="dt">\$</span>{3}.userLabel.userLabel.count_table)</a>
<a class="sourceLine" id="cb4-88" data-line-number="88"></a>
<a class="sourceLine" id="cb4-89" data-line-number="89">EOF2</a>
<a class="sourceLine" id="cb4-90" data-line-number="90"></a>
<a class="sourceLine" id="cb4-91" data-line-number="91">./mothur/mothur mothur<span class="dt">\$\$</span>.bat &gt; /dev/null</a>
<a class="sourceLine" id="cb4-92" data-line-number="92">mv in/hmp<span class="dt">\$</span>{3}.tre1.<span class="dt">\$</span>{fn}.phylip.dist out/mothur_<span class="dt">\$</span>{2}_dm<span class="dt">\$</span>{3}.tsv</a>
<a class="sourceLine" id="cb4-93" data-line-number="93">rm in/hmp<span class="dt">\$</span>{3}.<span class="dt">\$</span>{pf}summary</a>
<a class="sourceLine" id="cb4-94" data-line-number="94">rm in/hmp<span class="dt">\$</span>{3}.userLabel.shared </a>
<a class="sourceLine" id="cb4-95" data-line-number="95">rm in/hmp<span class="dt">\$</span>{3}.userLabel.userLabel.count_table</a>
<a class="sourceLine" id="cb4-96" data-line-number="96">rm mothur<span class="dt">\$\$</span>.bat</a>
<a class="sourceLine" id="cb4-97" data-line-number="97">rm mothur.*.logfile</a>
<a class="sourceLine" id="cb4-98" data-line-number="98"></a>
<a class="sourceLine" id="cb4-99" data-line-number="99"><span class="op">EOF1</span></a></code></pre></div>
<p>Finally, execute and time each script.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ex">/usr/bin/time</span> -f <span class="st">'Time: %E  Memory: %M\n'</span> Rscript rbiom.r    8 u 500</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="ex">/usr/bin/time</span> -f <span class="st">'Time: %E  Memory: %M\n'</span> Rscript phyloseq.r 8 u 500</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="ex">/usr/bin/time</span> -f <span class="st">'Time: %E  Memory: %M\n'</span> /bin/sh qiime2.sh  8 u 500</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="ex">/usr/bin/time</span> -f <span class="st">'Time: %E  Memory: %M\n'</span> /bin/sh usearch.sh 8 u 500</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="ex">/usr/bin/time</span> -f <span class="st">'Time: %E  Memory: %M\n'</span> /bin/sh mothur.sh  8 u 500</a></code></pre></div>
<p>Results using 8 cores, unweighted unifrac, and 500 samples:</p>
<table class="table">
<thead><tr class="header">
<th>Package</th>
<th align="right">Time (sec)</th>
<th align="right">Memory (kb)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>qiime2</td>
<td align="right">31</td>
<td align="right">690176</td>
</tr>
<tr class="even">
<td>phyloseq</td>
<td align="right">106</td>
<td align="right">1759328</td>
</tr>
<tr class="odd">
<td>usearch</td>
<td align="right">15</td>
<td align="right">17488</td>
</tr>
<tr class="even">
<td>rbiom</td>
<td align="right">1</td>
<td align="right">326624</td>
</tr>
<tr class="odd">
<td>mothur</td>
<td align="right">11</td>
<td align="right">823776</td>
</tr>
</tbody>
</table>
<p>Results using 1 core, weighted unifrac, and 4400 samples:</p>
<table class="table">
<thead><tr class="header">
<th>Package</th>
<th align="right">Time (sec)</th>
<th align="right">Memory (kb)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>rbiom</td>
<td align="right">408</td>
<td align="right">2938848</td>
</tr>
<tr class="even">
<td>qiime2</td>
<td align="right">149</td>
<td align="right">1952272</td>
</tr>
<tr class="odd">
<td>usearch</td>
<td align="right">1987</td>
<td align="right">603088</td>
</tr>
</tbody>
</table>
<p>Results using 20 cores, unweighted unifrac, and 4400 samples:</p>
<table class="table">
<thead><tr class="header">
<th>Package</th>
<th align="right">Time (sec)</th>
<th align="right">Memory (kb)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>rbiom</td>
<td align="right">51</td>
<td align="right">3106112</td>
</tr>
<tr class="even">
<td>qiime2</td>
<td align="right">130</td>
<td align="right">2300656</td>
</tr>
</tbody>
</table>
<p>Weighted Output matrices: rbiom == phyloseq != usearch Unweighted Output matrices: rbiom == phyloseq == qiime2 != usearch And unifrac_binary also doesn’t equal normalized unweighted phyloseq</p>
<p>Set these off in a loop</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">for</span> <span class="ex">i</span> in <span class="dt">{200..4400..200}</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">do</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="va">js=</span><span class="st">"1 4 8"</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="kw">if</span><span class="bu"> [</span> <span class="va">$i</span> <span class="ot">-eq</span> 4400<span class="bu"> ]</span>; <span class="kw">then</span> <span class="va">js=</span><span class="st">"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20"</span>; <span class="kw">fi</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="kw">for</span> <span class="ex">j</span> in js</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">    <span class="kw">for</span> <span class="fu">w</span> in w u</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">    <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">      <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f  <span class="st">"usearch </span><span class="va">$j</span><span class="st"> </span><span class="va">$w</span><span class="st"> </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh usearch.sh <span class="va">$j</span> <span class="va">$w</span> <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">      <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f   <span class="st">"qiime2 </span><span class="va">$j</span><span class="st"> </span><span class="va">$w</span><span class="st"> </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh qiime2.sh  <span class="va">$j</span> <span class="va">$w</span> <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">      <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f      <span class="st">"ssu </span><span class="va">$j</span><span class="st"> </span><span class="va">$w</span><span class="st"> </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh ssu.sh     <span class="va">$j</span> <span class="va">$w</span> <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">      <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f    <span class="st">"rbiom </span><span class="va">$j</span><span class="st"> </span><span class="va">$w</span><span class="st"> </span><span class="va">$i</span><span class="st"> %e %M"</span> Rscript rbiom.r    <span class="va">$j</span> <span class="va">$w</span> <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">      <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f <span class="st">"phyloseq </span><span class="va">$j</span><span class="st"> </span><span class="va">$w</span><span class="st"> </span><span class="va">$i</span><span class="st"> %e %M"</span> Rscript phyloseq.r <span class="va">$j</span> <span class="va">$w</span> <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17">      <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f   <span class="st">"mothur </span><span class="va">$j</span><span class="st"> </span><span class="va">$w</span><span class="st"> </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh mothur.sh  <span class="va">$j</span> <span class="va">$w</span> <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18">    <span class="kw">done</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19">  <span class="kw">done</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="kw">done</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="kw">for</span> <span class="ex">i</span> in 4400</a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="kw">do</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25">  <span class="kw">for</span> <span class="ex">j</span> in <span class="dt">{1..20}</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26">  <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27">    <span class="ex">/usr/bin/time</span> -a -o results.txt -f   <span class="st">"qiime2_aws </span><span class="va">$j</span><span class="st"> w </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh qiime2.sh  <span class="va">$j</span> w <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28">    <span class="ex">/usr/bin/time</span> -a -o results.txt -f   <span class="st">"qiime2_aws </span><span class="va">$j</span><span class="st"> u </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh qiime2.sh  <span class="va">$j</span> u <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29">  <span class="kw">done</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="kw">done</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="kw">for</span> <span class="ex">i</span> in <span class="dt">{1500..4300..100}</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="kw">do</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35">  <span class="kw">for</span> <span class="ex">j</span> in 1 4 8</a>
<a class="sourceLine" id="cb6-36" data-line-number="36">  <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37">    <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f   <span class="st">"mothur </span><span class="va">$j</span><span class="st"> w </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh mothur.sh  <span class="va">$j</span> w <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38">    <span class="ex">/usr/bin/time</span> -a -o ~/results.txt -f   <span class="st">"mothur </span><span class="va">$j</span><span class="st"> u </span><span class="va">$i</span><span class="st"> %e %M"</span> /bin/sh mothur.sh  <span class="va">$j</span> u <span class="va">$i</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39">  <span class="kw">done</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="kw">done</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"></a></code></pre></div>
<p>Make some graphs</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(ggplot2))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(cowplot))</a></code></pre></div>
<pre><code>## Warning: package 'cowplot' was built under R version 3.5.1</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">results &lt;-<span class="st"> </span><span class="kw">read.delim</span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="dt">file      =</span> <span class="st">"C:/Users/Daniel/Desktop/results.txt"</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">sep       =</span> <span class="st">' '</span>,</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">'Package'</span>, <span class="st">'Threads'</span>, <span class="st">'Algorithm'</span>, <span class="st">'Input.Size'</span>, <span class="st">'Time'</span>, <span class="st">'Memory'</span>),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  <span class="dt">row.names =</span> <span class="ot">NULL</span> )</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">results[[<span class="st">'Algorithm'</span>]] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(results[[<span class="st">'Algorithm'</span>]] <span class="op">==</span><span class="st"> 'w'</span>, <span class="st">'Weighted UniFrac'</span>, <span class="st">'Unweighted UniFrac'</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">results[[<span class="st">'Algorithm'</span>]] &lt;-<span class="st"> </span><span class="kw">paste</span>(results[[<span class="st">'Package'</span>]], <span class="st">"-"</span>, results[[<span class="st">'Algorithm'</span>]])</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">results &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/plyr/topics/ddply">ddply</a></span>(results, <span class="kw">c</span>(<span class="st">'Algorithm'</span>, <span class="st">'Input.Size'</span>), <span class="cf">function</span> (x) {</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  <span class="cf">if</span> (<span class="kw">nrow</span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">    x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">      <span class="st">'Package'</span>    =<span class="st"> </span>x[[<span class="st">'Package'</span>]], </a>
<a class="sourceLine" id="cb9-13" data-line-number="13">      <span class="st">'Threads'</span>    =<span class="st"> </span><span class="kw">unique</span>(results[[<span class="st">'Threads'</span>]]), </a>
<a class="sourceLine" id="cb9-14" data-line-number="14">      <span class="st">'Algorithm'</span>  =<span class="st"> </span>x[[<span class="st">'Algorithm'</span>]], </a>
<a class="sourceLine" id="cb9-15" data-line-number="15">      <span class="st">'Input.Size'</span> =<span class="st"> </span>x[[<span class="st">'Input.Size'</span>]], </a>
<a class="sourceLine" id="cb9-16" data-line-number="16">      <span class="st">'Time'</span>       =<span class="st"> </span>x[[<span class="st">'Time'</span>]], </a>
<a class="sourceLine" id="cb9-17" data-line-number="17">      <span class="st">'Memory'</span>     =<span class="st"> </span>x[[<span class="st">'Memory'</span>]]</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">    )</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  }</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">  <span class="kw">return</span> (x)</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">})</a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co"># Correct for `time` bug https://bugzilla.redhat.com/show_bug.cgi?id=702826</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24">results[[<span class="st">'Memory'</span>]] &lt;-<span class="st"> </span>results[[<span class="st">'Memory'</span>]] <span class="op">/</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co"># 4400 sample dataset, varying cpu count</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"></a>
<a class="sourceLine" id="cb9-31" data-line-number="31">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset.html">subset</a></span>(results, Input.Size <span class="op">==</span><span class="st"> </span><span class="dv">4400</span>)</a>
<a class="sourceLine" id="cb9-32" data-line-number="32"></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Threads, <span class="dt">y=</span>Time)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="st">  </span><span class="kw">scale_y_log10</span>(</a>
<a class="sourceLine" id="cb9-37" data-line-number="37">    <span class="dt">minor_breaks =</span> <span class="kw">c</span>(),</a>
<a class="sourceLine" id="cb9-38" data-line-number="38">    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)<span class="op">*</span><span class="dv">60</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">48</span>)<span class="op">*</span><span class="dv">3600</span>),</a>
<a class="sourceLine" id="cb9-39" data-line-number="39">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"00:00:01"</span>,<span class="st">"00:00:02"</span>,<span class="st">"00:00:05"</span>,<span class="st">"00:00:10"</span>,<span class="st">"00:00:20"</span>,</a>
<a class="sourceLine" id="cb9-40" data-line-number="40">               <span class="st">"00:01:00"</span>,<span class="st">"00:02:00"</span>,<span class="st">"00:05:00"</span>,<span class="st">"00:10:00"</span>,<span class="st">"00:20:00"</span>,</a>
<a class="sourceLine" id="cb9-41" data-line-number="41">               <span class="st">"01:00:00"</span>,<span class="st">"02:00:00"</span>,<span class="st">"05:00:00"</span>,<span class="st">"10:00:00"</span>,<span class="st">"24:00:00"</span>,</a>
<a class="sourceLine" id="cb9-42" data-line-number="42">               <span class="st">"48:00:00"</span>) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">minor_breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">'Paired'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-45" data-line-number="45"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Speed-up with Multiple CPU Cores"</span>, <span class="st">"Calculating UniFrac Distance Matrix from 4,400 Samples"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-46" data-line-number="46"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Number of Threads"</span>, <span class="dt">y =</span> <span class="st">"Time in HH:MM:SS (log scale)"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust=</span><span class="dv">2</span>))</a></code></pre></div>
<p><img src="benchmark_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># ggsave("C:/Users/Daniel/Desktop/Fig1.pdf", height=4, width=7)</span></a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co"># Single-Core CPU, varying dataset size</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset.html">subset</a></span>(results, Threads <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Input.Size, <span class="dt">y=</span>Time)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_log10</span>(</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">    <span class="dt">minor_breaks =</span> <span class="kw">c</span>(), </a>
<a class="sourceLine" id="cb11-12" data-line-number="12">    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)<span class="op">*</span><span class="dv">60</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">48</span>)<span class="op">*</span><span class="dv">3600</span>),</a>
<a class="sourceLine" id="cb11-13" data-line-number="13">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"00:00:01"</span>,<span class="st">"00:00:02"</span>,<span class="st">"00:00:05"</span>,<span class="st">"00:00:10"</span>,<span class="st">"00:00:20"</span>,</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">               <span class="st">"00:01:00"</span>,<span class="st">"00:02:00"</span>,<span class="st">"00:05:00"</span>,<span class="st">"00:10:00"</span>,<span class="st">"00:20:00"</span>,</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">               <span class="st">"01:00:00"</span>,<span class="st">"02:00:00"</span>,<span class="st">"05:00:00"</span>,<span class="st">"10:00:00"</span>,<span class="st">"24:00:00"</span>,</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">               <span class="st">"48:00:00"</span>) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">'Paired'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Single-Core CPU Processing Time"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Size of Dataset (# Samples)"</span>, <span class="dt">y =</span> <span class="st">"Time in HH:MM:SS (log scale)"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust=</span><span class="dv">2</span>))</a></code></pre></div>
<p><img src="benchmark_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># ggsave("C:/Users/Daniel/Desktop/Fig2.pdf", height=4, width=7)</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co"># 4-Core CPU, varying dataset size</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset.html">subset</a></span>(results, Threads <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Input.Size, <span class="dt">y=</span>Time)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_log10</span>(</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">    <span class="dt">minor_breaks =</span> <span class="kw">c</span>(), </a>
<a class="sourceLine" id="cb13-12" data-line-number="12">    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)<span class="op">*</span><span class="dv">60</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">48</span>)<span class="op">*</span><span class="dv">3600</span>),</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"00:00:01"</span>,<span class="st">"00:00:02"</span>,<span class="st">"00:00:05"</span>,<span class="st">"00:00:10"</span>,<span class="st">"00:00:20"</span>,</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">               <span class="st">"00:01:00"</span>,<span class="st">"00:02:00"</span>,<span class="st">"00:05:00"</span>,<span class="st">"00:10:00"</span>,<span class="st">"00:20:00"</span>,</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">               <span class="st">"01:00:00"</span>,<span class="st">"02:00:00"</span>,<span class="st">"05:00:00"</span>,<span class="st">"10:00:00"</span>,<span class="st">"24:00:00"</span>,</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">               <span class="st">"48:00:00"</span>) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">'Paired'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"4-Core CPU Processing Time"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Size of Dataset (# Samples)"</span>, <span class="dt">y =</span> <span class="st">"Time in HH:MM:SS (log scale)"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust=</span><span class="dv">2</span>))</a></code></pre></div>
<p><img src="benchmark_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># ggsave("C:/Users/Daniel/Desktop/Fig3.pdf", height=4, width=7)</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co"># 8-Core CPU, varying dataset size</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset.html">subset</a></span>(results, Threads <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Input.Size, <span class="dt">y=</span>Time)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_log10</span>(</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">    <span class="dt">minor_breaks =</span> <span class="kw">c</span>(), </a>
<a class="sourceLine" id="cb15-12" data-line-number="12">    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>), <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)<span class="op">*</span><span class="dv">60</span>, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">48</span>)<span class="op">*</span><span class="dv">3600</span>),</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">"00:00:01"</span>,<span class="st">"00:00:02"</span>,<span class="st">"00:00:05"</span>,<span class="st">"00:00:10"</span>,<span class="st">"00:00:20"</span>,</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">               <span class="st">"00:01:00"</span>,<span class="st">"00:02:00"</span>,<span class="st">"00:05:00"</span>,<span class="st">"00:10:00"</span>,<span class="st">"00:20:00"</span>,</a>
<a class="sourceLine" id="cb15-15" data-line-number="15">               <span class="st">"01:00:00"</span>,<span class="st">"02:00:00"</span>,<span class="st">"05:00:00"</span>,<span class="st">"10:00:00"</span>,<span class="st">"24:00:00"</span>,</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">               <span class="st">"48:00:00"</span>) ) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">'Paired'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"8-Core CPU Processing Time"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Size of Dataset (# Samples)"</span>, <span class="dt">y =</span> <span class="st">"Time in HH:MM:SS (log scale)"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">vjust=</span><span class="dv">2</span>))</a></code></pre></div>
<p><img src="benchmark_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># ggsave("C:/Users/Daniel/Desktop/Fig4.pdf", height=4, width=7)</span></a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co"># QIIME 2 summary</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#==========================================</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw">theme_set</span>(<span class="kw">theme_gray</span>(<span class="dt">base_size =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"></a>
<a class="sourceLine" id="cb17-7" data-line-number="7">df &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset.html">subset</a></span>(results, Package <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"qiime2"</span>, <span class="st">"ssu"</span>))</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">df[[<span class="st">'Time'</span>]]   &lt;-<span class="st"> </span>df[[<span class="st">'Time'</span>]] <span class="op">/</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">df[[<span class="st">'Memory'</span>]] &lt;-<span class="st"> </span>df[[<span class="st">'Memory'</span>]] <span class="op">/</span><span class="st"> </span><span class="dv">1024</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#df[['Algorithm']] &lt;- sub("qiime2 - ", "", df[['Algorithm']])</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"></a>
<a class="sourceLine" id="cb17-12" data-line-number="12">df12 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset.html">subset</a></span>(df, Input.Size <span class="op">==</span><span class="st"> </span><span class="dv">4400</span>)</a>
<a class="sourceLine" id="cb17-13" data-line-number="13"></a>
<a class="sourceLine" id="cb17-14" data-line-number="14">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df12, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Threads, <span class="dt">y=</span>Time)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Number of Threads"</span>, <span class="dt">y =</span> <span class="st">"Runtime in Minutes"</span>)</a>
<a class="sourceLine" id="cb17-18" data-line-number="18"></a>
<a class="sourceLine" id="cb17-19" data-line-number="19">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df12, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Threads, <span class="dt">y=</span>Memory)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-22" data-line-number="22"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Number of Threads"</span>, <span class="dt">y =</span> <span class="st">"Memory in Megabytes"</span>)</a>
<a class="sourceLine" id="cb17-23" data-line-number="23"></a>
<a class="sourceLine" id="cb17-24" data-line-number="24"></a>
<a class="sourceLine" id="cb17-25" data-line-number="25">df34 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset.html">subset</a></span>(df, Threads <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-26" data-line-number="26"></a>
<a class="sourceLine" id="cb17-27" data-line-number="27">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df34, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Input.Size, <span class="dt">y=</span>Time)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-28" data-line-number="28"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-30" data-line-number="30"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Dataset Size"</span>, <span class="dt">y =</span> <span class="st">"Runtime in Minutes"</span>)</a>
<a class="sourceLine" id="cb17-31" data-line-number="31"></a>
<a class="sourceLine" id="cb17-32" data-line-number="32">p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df34, <span class="kw">aes</span>(<span class="dt">group=</span>Algorithm, <span class="dt">color=</span>Algorithm, <span class="dt">x=</span>Input.Size, <span class="dt">y=</span>Memory)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span>.<span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Dataset Size"</span>, <span class="dt">y =</span> <span class="st">"Memory in Meggabytes"</span>)</a>
<a class="sourceLine" id="cb17-36" data-line-number="36"></a>
<a class="sourceLine" id="cb17-37" data-line-number="37"></a>
<a class="sourceLine" id="cb17-38" data-line-number="38">pTop &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb17-39" data-line-number="39">  <span class="dt">ncol=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb17-40" data-line-number="40">  <span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb17-41" data-line-number="41">  <span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">draw_label</span>(<span class="st">"Dataset of 4,400 Samples; Varying the Number of Threads"</span>, <span class="dt">fontface=</span><span class="st">'bold'</span>, <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">x=</span><span class="fl">0.05</span>, <span class="dt">hjust=</span><span class="dv">0</span>), </a>
<a class="sourceLine" id="cb17-42" data-line-number="42">  <span class="kw">plot_grid</span>( </a>
<a class="sourceLine" id="cb17-43" data-line-number="43">    p1 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"none"</span>),</a>
<a class="sourceLine" id="cb17-44" data-line-number="44">    p2 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"none"</span>),</a>
<a class="sourceLine" id="cb17-45" data-line-number="45">    <span class="dt">align =</span> <span class="st">'vh'</span>,</a>
<a class="sourceLine" id="cb17-46" data-line-number="46">    <span class="dt">nrow =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb17-47" data-line-number="47">  )</a>
<a class="sourceLine" id="cb17-48" data-line-number="48">)</a>
<a class="sourceLine" id="cb17-49" data-line-number="49"></a>
<a class="sourceLine" id="cb17-50" data-line-number="50">pBot &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb17-51" data-line-number="51">  <span class="dt">ncol=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb17-52" data-line-number="52">  <span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb17-53" data-line-number="53">  <span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">draw_label</span>(<span class="st">"Single-Threaded; Varying the Dataset Size"</span>, <span class="dt">fontface=</span><span class="st">'bold'</span>, <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">x=</span><span class="fl">0.05</span>, <span class="dt">hjust=</span><span class="dv">0</span>), </a>
<a class="sourceLine" id="cb17-54" data-line-number="54">  <span class="kw">plot_grid</span>( </a>
<a class="sourceLine" id="cb17-55" data-line-number="55">    p3 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"none"</span>),</a>
<a class="sourceLine" id="cb17-56" data-line-number="56">    p4 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"none"</span>),</a>
<a class="sourceLine" id="cb17-57" data-line-number="57">    <span class="dt">align =</span> <span class="st">'vh'</span>,</a>
<a class="sourceLine" id="cb17-58" data-line-number="58">    <span class="dt">nrow =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb17-59" data-line-number="59">  )</a>
<a class="sourceLine" id="cb17-60" data-line-number="60">)</a>
<a class="sourceLine" id="cb17-61" data-line-number="61"></a>
<a class="sourceLine" id="cb17-62" data-line-number="62"></a>
<a class="sourceLine" id="cb17-63" data-line-number="63">legend &lt;-<span class="st"> </span><span class="kw">get_legend</span>(p1 <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_discrete</span>(<span class="dt">name=</span><span class="st">""</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"bottom"</span>, <span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="dv">1</span>,<span class="st">"line"</span>), <span class="dt">legend.key.height =</span> <span class="kw">unit</span>(.<span class="dv">2</span>,<span class="st">"line"</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">color=</span><span class="kw">guide_legend</span>(<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb17-64" data-line-number="64"></a>
<a class="sourceLine" id="cb17-65" data-line-number="65">p &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(legend, pTop, pBot, <span class="dt">ncol=</span><span class="dv">1</span>, <span class="dt">rel_heights=</span><span class="kw">c</span>(.<span class="dv">2</span>, <span class="fl">.8</span>, <span class="fl">.8</span>))</a>
<a class="sourceLine" id="cb17-66" data-line-number="66">cowplot<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/cowplot/topics/ggsave">ggsave</a></span>(<span class="st">"C:/Users/Daniel/Desktop/qiime2-ssu.png"</span>, p, <span class="dt">height=</span><span class="dv">2</span>, <span class="dt">width=</span><span class="dv">2</span>)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#create-test-environment">Create Test Environment</a></li>
      <li><a href="#prepare-input-data">Prepare input data</a></li>
      <li><a href="#weighted-unifrac">Weighted UniFrac</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Daniel P. Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
